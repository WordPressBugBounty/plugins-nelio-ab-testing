(()=>{var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};(()=>{"use strict";e.r(t),e.d(t,{experiments:()=>i});var n={};e.r(n),e.d(n,{getExperimentSupport:()=>c,getExperimentType:()=>p,getExperimentTypes:()=>l,getExperimentView:()=>d,getHelpString:()=>f,hasExperimentSupport:()=>u});var r={};e.r(r),e.d(r,{addExperimentTypes:()=>m,removeExperimentTypes:()=>y});var i={};e.r(i),e.d(i,{getAlternativeError:()=>F,getTestedElementError:()=>M,isTestedElementInvalid:()=>A,onValidateAlternative:()=>V,onValidateTestedElement:()=>R,registerExperimentType:()=>x,store:()=>h});const o=window.wp.data,a=window.lodash,s=window.nab.utils;function l(e){return e.experimentTypes}function p(e,t){return e.experimentTypes[t]}var c=function(e,t,n){var r=v(e,t);return null==r?void 0:r.supports[n]};function u(e,t,n){return!!c(e,t,n)}function d(e,t,n){var r=v(e,t);if(r)return r.views[n]}function f(e,t,n){var r=v(e,t);return(null==r?void 0:r.help[n])||""}var v=function(e,t){return"string"==typeof t?p(e,t):t};function m(e){return{type:"ADD_EXPERIMENT_TYPES",experimentTypes:(0,a.castArray)(e)}}function y(e){return{type:"REMOVE_EXPERIMENT_TYPES",names:(0,a.castArray)(e)}}var g={experimentTypes:{}},E=function(){return E=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},E.apply(this,arguments)},h=(0,o.createReduxStore)("nab/experiments",{reducer:function(e,t){var n;return void 0===e&&(e=g),null!==(n=function(e,t){switch(t.type){case"ADD_EXPERIMENT_TYPES":return E(E({},e),{experimentTypes:E(E({},e.experimentTypes),(0,a.keyBy)(t.experimentTypes,"name"))});case"REMOVE_EXPERIMENT_TYPES":return E(E({},e),{experimentTypes:(0,a.omit)(e.experimentTypes,t.names)})}}(e,t))&&void 0!==n?n:e},selectors:n,actions:r});!function(e){(0,o.register)(e)}(h);var T=function(){return T=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},T.apply(this,arguments)};function x(e,t){var n=T({name:e,description:"",supports:{}},t);if("nab/heatmap"===e)return(0,o.dispatch)(h).addExperimentTypes(n),n;if("string"==typeof e)if(/^[a-z][a-z0-9-]*\/[a-z][a-z0-9-]*$/.test(e))if((0,o.select)(h).getExperimentType(e))console.error("Experiment type “".concat(e,"” is already registered."));else if(b(n))if(w(n))if(O(n))if(P(n))if((0,s.isValidIcon)(t.icon))if(S(n)){if(_(n))return(0,o.dispatch)(h).addExperimentTypes(n),n;console.error("The experiment “".concat(e,"” must specify original and alternative edit views."))}else console.error("The experiment “".concat(e,"” must specify original and alternative default values."));else console.error("The icon passed is invalid. The icon should be an element or a function.");else console.error("The experiment “".concat(e,"” must have an icon."));else console.error("The experiment “".concat(e,"” must have a title."));else console.error("The experiment “".concat(e,"” must have a valid category."));else console.error("The experiment “".concat(e,"” must provide help strings explaining the control version and its variants."));else console.error("Experiment type names must contain a namespace prefix, include only lowercase alphanumeric characters or dashes, and start with a letter. Example: my-plugin/my-custom-experiment");else console.error("Experiment type names must be strings.")}var b=function(e){return!!e.help&&"string"==typeof e.help.original&&!!e.help.original&&"string"==typeof e.help.alternative&&!!e.help.alternative},w=function(e){var t;return["page","global","woocommerce","other"].includes(null!==(t=e.category)&&void 0!==t?t:"")},O=function(e){return"string"==typeof e.title&&!!e.title},P=function(e){return"icon"in e},_=function(e){var t,n;return(0,a.isFunction)(null===(t=e.views)||void 0===t?void 0:t.original)&&(0,a.isFunction)(null===(n=e.views)||void 0===n?void 0:n.alternative)},S=function(e){var t,n;return(0,a.isObject)(null===(t=e.views)||void 0===t?void 0:t.original)&&(0,a.isObject)(null===(n=e.defaults)||void 0===n?void 0:n.alternative)};const I=window.wp.hooks,j=window.wp.i18n;function A(e,t){return!!M(e,t)}function M(e,t){var n=e.attributes,r=!(n&&!(0,s.isEmpty)(n)&&(0,a.values)(n).filter((function(e){return"boolean"!=typeof e})).filter((function(e){return void 0!==e})).every((function(e){return!!e})))&&(0,j._x)("Test doesn’t specify the tested element","text","nelio-ab-testing"),i=(0,I.applyFilters)("nab.isTestedElementInvalid",r,n,t);return"string"==typeof i&&i}function R(e,t){(0,I.addFilter)("nab.isTestedElementInvalid","nab/is".concat(C(e.name),"TestedElementInvalid"),(function(n,r,i){return e.name!==i?n:t(r)}))}function F(e,t,n){var r=(0,I.applyFilters)("nab.isAlternativeInvalid",!1,e.attributes,z(t),n);return"string"==typeof r&&r}function V(e,t){(0,I.addFilter)("nab.isAlternativeInvalid","nab/is".concat(C(e.name),"AlternativeInvalid"),(function(n,r,i,o){return e.name!==o?n:t(r,i)}))}var z=function(e){return String.fromCharCode("B".charCodeAt(0)+e)},C=function(e){return(0,a.startCase)(e).replaceAll(" ","")}})();var n=nab="undefined"==typeof nab?{}:nab;for(var r in t)n[r]=t[r];t.__esModule&&Object.defineProperty(n,"__esModule",{value:!0})})();