(()=>{var e,t={5847(e,t,n){"use strict";n.r(t),n.d(t,{initPage:()=>B});const i=window.ReactJSXRuntime,a=(window.wp.domReady,window.wp.element),s=window.wp.components,o=(Object.assign(e=>(0,i.jsx)(s.BaseControl,Object.assign({__nextHasNoMarginBottom:!0},e)),s.BaseControl),Object.assign(e=>(0,i.jsx)(s.CheckboxControl,Object.assign({__nextHasNoMarginBottom:!0},e)),s.CheckboxControl)),l=(Object.assign(e=>(0,i.jsx)(s.FormTokenField,Object.assign({__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0},e)),s.FormTokenField),Object.assign(e=>(0,i.jsx)(s.RangeControl,Object.assign({__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0},e)),s.RangeControl),Object.assign(e=>(0,i.jsx)(s.TextControl,Object.assign({__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0},e)),s.TextControl)),r=Object.assign(e=>(0,i.jsx)(s.TextareaControl,Object.assign({__nextHasNoMarginBottom:!0},e)),s.TextareaControl),c=(Object.assign(e=>(0,i.jsx)(s.ToggleControl,Object.assign({__nextHasNoMarginBottom:!0},e)),s.ToggleControl),Object.assign(e=>(0,i.jsx)(s.__experimentalToggleGroupControl,Object.assign({__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0},e)),s.__experimentalToggleGroupControl),window.wp.apiFetch);var d=n.n(c);const g=window.wp.date,u=window.wp.url,b=e=>{const{url:t,path:n}=e,i=(0,g.format)("YmjHi").substring(0,11)+"0";return d()(Object.assign(Object.assign(Object.assign(Object.assign({},e),t&&{url:x(e)?(0,u.addQueryArgs)(t,{nabts:i}):t}),n&&{path:(0,u.addQueryArgs)(n,{nabts:i})}),{parse:!0}))},x=e=>{var t,n;return!!(null===(t=e.url)||void 0===t?void 0:t.includes("/wp-json/"))||!!(null===(n=e.url)||void 0===n?void 0:n.includes("rest_route"))||!!Object.keys(e).includes("rest_route")},p=window.wp.i18n,m=window.lodash,v=window.nab.components,j=window.nab.data,h=e=>{const t=C(e);return(0,i.jsxs)("div",{className:"nelio-ab-testing-deactivation",children:[(0,i.jsx)(s.Button,{className:"nelio-ab-testing-deactivation__button",variant:"link",onClick:t.openModal,children:(0,p._x)("Deactivate","command","nelio-ab-testing")}),(0,i.jsx)(_,{state:t})]})},_=({state:e})=>{if(!e.isModalOpen)return null;let t;switch(e.reason.value){case"temporary-deactivation":t=O;break;case"plugin-doesnt-work":t=S;break;default:t=w}return(0,i.jsx)(s.Modal,{className:"nelio-ab-testing-deactivation__modal",title:(0,p._x)("Nelio A/B Testing Deactivation","text","nelio-ab-testing"),isDismissible:!e.isLocked,shouldCloseOnEsc:!e.isLocked,shouldCloseOnClickOutside:!e.isLocked,onRequestClose:e.closeModal,children:(0,i.jsx)(t,Object.assign({},e))})},O=({deactivate:e,isDeactivating:t,mainActionLabel:n,reason:a,setReason:o})=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(v.RadioControl,{selected:a.value,options:T,onChange:e=>o({value:e,details:""}),disabled:t}),(0,i.jsx)("br",{}),(0,i.jsxs)("div",{className:"nelio-ab-testing-deactivation__actions",children:[(0,i.jsx)("span",{}),(0,i.jsx)(s.Button,{variant:"primary",disabled:t||"clean-stuff"===a.value,onClick:()=>e(),children:n})]})]}),S=({closeModal:e,lock:t,setReason:n})=>{const[o,c]=(0,a.useState)(D),{isTicketSubmitting:d,description:g,email:x,submissionError:v}=o,h=(0,m.trim)(g).length&&(0,u.isEmail)(x),_=e=>c(Object.assign(Object.assign({},o),e)),O=(0,j.usePluginSetting)("siteId"),S=(0,j.usePluginSetting)("homeUrl"),w=!!(0,j.usePluginSetting)("subscription"),C=(0,j.usePluginSetting)("apiUrl");return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r,{label:(0,p._x)("The Problem:","text","nelio-ab-testing"),disabled:d,placeholder:(0,p._x)("Tell us what’s going on","user","nelio-ab-testing"),value:g,onChange:e=>_({description:e})}),(0,i.jsx)(l,{label:(0,p._x)("Your Email:","text","nelio-ab-testing"),disabled:d,value:x,onChange:e=>_({email:e})}),v&&(0,i.jsxs)("p",{className:"nelio-ab-testing-deactivation__warning",children:[(0,i.jsx)(s.Dashicon,{icon:"warning"}),(0,i.jsx)("span",{children:(0,p.sprintf)(/* translators: %s: Email address. */ /* translators: %s: Email address. */
(0,p._x)("Something went wrong and we couldn’t receive your support request. Please try again later or send us an email to %s.","user","nelio-ab-testing"),"support@neliosoftware.com")})]}),(0,i.jsx)("br",{}),(0,i.jsxs)("div",{className:"nelio-ab-testing-deactivation__actions",children:[(0,i.jsx)(s.Button,{variant:"link",onClick:()=>n({value:"other",details:""}),children:(0,p._x)("Back","command","nelio-ab-testing")}),(0,i.jsx)(s.Button,{variant:"primary",disabled:!h||d,isBusy:d,onClick:()=>{t(),_({isTicketSubmitting:!0}),b({url:`${C}/ticket`,credentials:"omit",method:"POST",mode:"cors",data:{email:x,description:N(g,O,S,w),subject:"I can’t get the plugin to work and need help"}}).then(e).catch(()=>{_({submissionError:!0,isTicketSubmitting:!1}),t(!1)})},children:d?(0,p._x)("Submitting…","text","nelio-ab-testing"):(0,p._x)("Submit and Keep Plugin","command","nelio-ab-testing")})]})]})},w=({isLocked:e,isSubscribed:t,isStagingSite:n,mainActionLabel:a,cleanAndDeactivate:l,reason:r,setReason:c,deleteStagingDataOnly:d,setDeleteStagingDataOnly:g})=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("p",{children:(0,p._x)("If you have a moment, please share why you are deactivating Nelio A/B Testing:","user","nelio-ab-testing")}),(0,i.jsx)(v.RadioControl,{className:"nelio-ab-testing-deactivation__options",selected:r.value,options:M,onChange:e=>c({value:e,details:""}),extraValue:r.details,onExtraChange:e=>c(Object.assign(Object.assign({},r),{details:e})),disabled:e}),t&&n&&(0,i.jsx)("p",{className:"nelio-ab-testing-deactivation__staging-check",children:(0,i.jsx)(o,{label:(0,p._x)("Delete staging data only","text","nelio-ab-testing"),checked:d,onChange:g,help:(0,p._x)("Keep this checked to delete data on this staging site only, while preserving data on your live site.","user","nelio-ab-testing")})}),t&&(0,i.jsxs)("p",{className:"nelio-ab-testing-deactivation__warning",children:[(0,i.jsx)(s.Dashicon,{icon:"warning"}),(0,i.jsx)("span",{children:(0,p._x)("Deactivating the plugin does not cancel your Nelio A/B Testing subscription. To unsubscribe, visit the plugin’s Account page first.","user","nelio-ab-testing")})]}),(0,i.jsxs)("div",{className:"nelio-ab-testing-deactivation__actions",children:[e?(0,i.jsx)("span",{}):(0,i.jsx)(s.Button,{variant:"link",disabled:e,onClick:()=>l(d),children:(0,p._x)("Just Delete Data","command","nelio-ab-testing")}),(0,i.jsx)(s.Button,{variant:"primary",disabled:e||"clean-stuff"===r.value,onClick:()=>l(d,r.details?`${r.value}: ${r.details}`:r.value),children:a})]})]}),C=({cleanNonce:e,deactivationUrl:t,isSubscribed:n,isStagingSite:i})=>{const[s,o]=(0,a.useState)(f),l=()=>{window.location.href=t},r=()=>o(Object.assign(Object.assign({},f),{isModalOpen:!1})),c="temporary-deactivation"===s.reason.value?y(s.isDeactivating):k(s.isDeactivating);return{isModalOpen:s.isModalOpen,openModal:()=>o(Object.assign(Object.assign({},f),{isModalOpen:!0})),closeModal:r,isDeactivating:s.isDeactivating,isSubscribed:n,isStagingSite:i,mainActionLabel:c,deactivate:()=>{o(Object.assign(Object.assign({},s),{reason:f.reason,isDeactivating:!0,isLocked:!0})),l()},cleanAndDeactivate:(t,n)=>{o(Object.assign(Object.assign({},s),{isDeactivating:!0})),b({path:"/nab/v1/plugin/clean",method:"POST",data:{deleteStagingDataOnly:t,reason:n,nabnonce:e}}).then(l,r)},isLocked:s.isLocked,lock:(e=!0)=>o(Object.assign(Object.assign({},s),{isLocked:e})),reason:s.reason,setReason:e=>o(Object.assign(Object.assign({},s),{reason:e})),deleteStagingDataOnly:s.deleteStagingDataOnly,setDeleteStagingDataOnly:e=>o(Object.assign(Object.assign({},s),{deleteStagingDataOnly:e}))}},y=e=>e?(0,p._x)("Deactivating…","text","nelio-ab-testing"):(0,p._x)("Deactivate","command","nelio-ab-testing"),k=e=>e?(0,p._x)("Deleting Data…","text","nelio-ab-testing"):(0,p._x)("Submit and Delete Data","command","nelio-ab-testing"),f={isModalOpen:!1,isDeactivating:!1,isLocked:!1,reason:{value:"temporary-deactivation",details:""},deleteStagingDataOnly:!0},D={isTicketSubmitting:!1,email:"",description:"",submissionError:!1},T=[{value:"temporary-deactivation",label:(0,p._x)("It’s a temporary deactivation","text","nelio-ab-testing")},{value:"clean-stuff",label:(0,p._x)("Delete Nelio A/B Testing’s data and deactivate plugin","text","nelio-ab-testing")}],M=[{value:"plugin-no-longer-needed",label:(0,p._x)("I no longer need the plugin","text","nelio-ab-testing")},{value:"plugin-doesnt-work",label:(0,p._x)("I couldn’t get the plugin to work","text","nelio-ab-testing")},{value:"better-plugin-found",label:(0,p._x)("I found a better plugin","text","nelio-ab-testing"),extra:(0,p._x)("What’s the plugin’s name?","text","nelio-ab-testing")},{value:"other",label:(0,p._x)("Other","text","nelio-ab-testing"),extra:(0,p._x)("Please share the reason…","user","nelio-ab-testing")}];function N(e,t,n,i){const a=document.createElement("div"),s=()=>document.createElement("br"),o=document.createElement("strong");o.textContent="Additional Information";const l=document.createElement("ul"),r=document.createElement("li");r.textContent=`Site ID: ${t}`;const c=document.createElement("li");c.textContent=`Site URL: ${n}`;const d=document.createElement("li");return d.textContent="Subscribed: "+(i?"yes":"no"),l.appendChild(r),l.appendChild(c),l.appendChild(d),(0,m.trim)(e).split(/\n+/).forEach(e=>{const t=document.createTextNode(e);a.appendChild(t),a.appendChild(s()),a.appendChild(s())}),a.appendChild(o),a.appendChild(s()),a.appendChild(l),a.innerHTML}function B(e){const{isSubscribed:t,isStagingSite:n,cleanNonce:o,deactivationUrl:l}=e,r=document.querySelector(".nelio-ab-testing-deactivate-link");var c,d;r&&(c=(0,i.jsxs)(s.SlotFillProvider,{children:[(0,i.jsx)(h,{isSubscribed:t,isStagingSite:n,deactivationUrl:l,cleanNonce:o}),(0,i.jsx)(s.Popover.Slot,{})]}),(d=r)&&(a.createRoot?(0,a.createRoot)(d).render(c):(0,a.render)(c,d)))}}},n={};function i(e){var a=n[e];if(void 0!==a)return a.exports;var s=n[e]={exports:{}};return t[e](s,s.exports,i),s.exports}e=[],i.O=(t,n,a,s)=>{if(!n){var o=1/0;for(d=0;d<e.length;d++){for(var[n,a,s]=e[d],l=!0,r=0;r<n.length;r++)(!1&s||o>=s)&&Object.keys(i.O).every(e=>i.O[e](n[r]))?n.splice(r--,1):(l=!1,s<o&&(o=s));if(l){e.splice(d--,1);var c=a();void 0!==c&&(t=c)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[n,a,s]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a=i.O(void 0,[6376],()=>i(5847));a=i.O(a);var s=nab="undefined"==typeof nab?{}:nab;for(var o in a)s[o]=a[o];a.__esModule&&Object.defineProperty(s,"__esModule",{value:!0})})();