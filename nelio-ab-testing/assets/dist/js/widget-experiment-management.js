(()=>{var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};(()=>{"use strict";var t={};e.r(t),e.d(t,{initAlternativeEdition:()=>C,initControlEdition:()=>x});var n={};e.r(n),e.d(n,{initAlternativeEdition:()=>B,initControlEdition:()=>P});const i=window.wp.element;function r(e,t){t&&(i.createRoot?(0,i.createRoot)(t).render(e):(0,i.render)(e,t))}const o=window.wp.data;var a=window.wp.blockEditor.store;const l=window.nab.utils,c=window.lodash;var u=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))};function d(e){var t=document.getElementById("nab-widget-global-style");if(t){var n=e.reduce((function(e,t){return"".concat(e,"\n#block-").concat(t," { display: none; }")}),"");t.textContent=n}}function s(e){var t=e.attributes.id;return"string"==typeof t&&t.startsWith("nab_alt_sidebar")}const f=window.wp.apiFetch;var p=e.n(f);const m=window.wp.date,b=window.wp.url;var g=function(){return g=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},g.apply(this,arguments)};const w=function(e){var t=e.url,n=e.path,i=(0,m.format)("YmjHi").substring(0,11)+"0";return p()(g(g(g({},e),t&&{url:v(e)?(0,b.addQueryArgs)(t,{nabts:i}):t}),n&&{path:(0,b.addQueryArgs)(n,{nabts:i})}))};var v=function(e){var t,n;return!!(null===(t=e.url)||void 0===t?void 0:t.includes("/wp-json/"))||!!(null===(n=e.url)||void 0===n?void 0:n.includes("rest_route"))||!!Object.keys(e).includes("rest_route")};const y=window.wp.components,h=window.wp.i18n,E=window.nab.components;var _=function(e){var t=e.experiment,n=e.alternative,r=(0,i.useState)(!1),o=r[0],a=r[1],l=(0,i.useState)(!1),c=l[0],u=l[1],d=o?(0,h._x)("Duplicating…","text (widgets)","nelio-ab-testing"):(0,h._x)("Duplicate","command","nelio-ab-testing");return i.createElement(i.Fragment,null,i.createElement(y.Button,{variant:"secondary",onClick:function(){return u(!0)}},(0,h._x)("Duplicate Control Widgets","command","nelio-ab-testing")),i.createElement(E.ConfirmationDialog,{title:(0,h._x)("Duplicate Control Widgets?","title","nelio-ab-testing"),text:(0,h._x)("This will overwrite any widgets you may have in this variant with those included in your theme. Are you sure you want to continue?","user","nelio-ab-testing"),confirmLabel:d,isConfirmEnabled:!o,isCancelEnabled:!o,isDismissible:!o,isOpen:c,onCancel:function(){return u(!1)},onConfirm:function(){o||(a(!0),w({path:(0,b.addQueryArgs)("/nab/v1/widget/duplicate-control",{experiment:t,alternative:n}),method:"PUT"}).finally((function(){return window.location.reload()})))}}))};function x(){var e,t;e=[],t=(0,c.debounce)((function(){var t=(0,o.select)(a).getBlocks().filter((function(e){return"core/widget-area"===e.name})),n=t.map((function(e){return e.clientId}));(0,l.areEqual)(e,n)||(e=n,d(t.filter(s).map((function(e){return e.clientId}))))}),100),(0,o.subscribe)(t,a),t()}function C(e){!function(e){e=u(u([],e,!0),["wp_inactive_widgets"],!1);var t=[],n=(0,c.debounce)((function(){var n=(0,o.select)(a).getBlocks().filter((function(e){return"core/widget-area"===e.name})),i=n.map((function(e){return e.clientId}));(0,l.areEqual)(t,i)||(t=i,d(n.filter((function(t){var n=t.attributes.id;return"string"==typeof n&&!e.includes(n)})).map((function(e){return e.clientId}))))}),100);(0,o.subscribe)(n,a),n()}(e.sidebars),function(e){var t=0,n=function(){var o,a=document.querySelector(".edit-widgets-header__actions");!(null===(o=null==a?void 0:a.children)||void 0===o?void 0:o.length)&&t<40?setTimeout(n,250*++t):a&&function(t){var n=t.children[0];if(n){var o=document.createElement("div");t.insertBefore(o,n),r(i.createElement(_,{experiment:e.experiment,alternative:e.alternative}),o)}}(a)};n()}(e)}const A=window.nab.data;function S(){return Array.from(document.querySelectorAll("div[id^=nab_alt_sidebar_]"))}function O(){S().forEach((function(e){return function(e){var t=function(e){var t=e.replace(/^nab_alt_sidebar_[0-9]+_([^-]+-){4}[^-]+_/,"");return t===e?"":t}(e.getAttribute("id")||"");if(t){var n=document.getElementById(t);n&&e.parentElement&&n.parentElement&&(0,l.appendSibling)(e.parentElement,n.parentElement)}}(e)}))}var D=function(e){var t=e.experiment,n=e.alternative,r=j(),o=r[0],a=r[1],l=k(t,n),c=l[0],u=l[1];return i.createElement("span",null,i.createElement(y.Button,{className:"page-title-action",onClick:function(){return a(!0)},style:{height:"auto"}},(0,h._x)("Duplicate Control Widgets","command","nelio-ab-testing")),i.createElement(E.ConfirmationDialog,{title:(0,h._x)("Duplicate Control Widgets?","title","nelio-ab-testing"),text:(0,h._x)("This will overwrite any widgets you may have in this variant with those included in your theme. Are you sure you want to continue?","user","nelio-ab-testing"),confirmLabel:c?(0,h._x)("Duplicating…","text (widgets)","nelio-ab-testing"):(0,h._x)("Duplicate","command","nelio-ab-testing"),isConfirmEnabled:!c,isCancelEnabled:!c,isOpen:o,onCancel:function(){return a(!1)},onConfirm:u}))},j=function(){return(0,A.usePageAttribute)("widgets/isConfirmationDialogForWidgetDuplicationVisible",!1)},k=function(e,t){var n=(0,A.usePageAttribute)("widgets/isDuplicatingWidgets",!1),r=n[0],o=n[1];return(0,i.useEffect)((function(){r&&w({path:(0,b.addQueryArgs)("/nab/v1/widget/duplicate-control",{experiment:e,alternative:t}),method:"PUT"}).finally((function(){window.location.reload()}))}),[r]),[r,function(){return o(!0)}]};function P(){O(),S().forEach((function(e){e.parentElement&&(e.parentElement.style.display="none")}))}function B(e){var t;O(),Array.from(document.querySelectorAll(".sidebars-column-1 > .widgets-holder-wrap, .sidebars-column-2 > .widgets-holder-wrap")).forEach((function(e){return e.style.display="none"})),(0,c.filter)(e.sidebars.map((function(e){return document.getElementById(e)})),(function(e){return!!e})).forEach((function(e){e.parentElement&&(e.parentElement.style.display="block")})),(t=document.querySelector("#wpbody-content .wrap .wp-heading-inline"))&&(t.textContent=(0,h._x)("Widget Variant","text","nelio-ab-testing")),Array.from(document.querySelectorAll(".page-title-action")).forEach((function(e){return e.remove()})),function(e){var t=document.querySelector("#wpbody-content .wrap .wp-heading-inline"),n=document.createElement("div");r(i.createElement(D,{experiment:e.experiment,alternative:e.alternative}),n);var o=n.children[0],a=document.createElement("a");a.className="page-title-action",a.textContent=(0,h._x)("Back to Test","command","nelio-ab-testing"),a.setAttribute("href",e.links.experimentUrl),t&&((0,l.appendSibling)(a,t),o&&(0,l.appendSibling)(o,t))}(e)}var q,T=function(){return T=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},T.apply(this,arguments)};window.nab=T(T({},(q=window)&&"object"==typeof q&&"nab"in q?window.nab:{}),{widgets:{blocks:t,classic:n}})})();var n=nab="undefined"==typeof nab?{}:nab;for(var i in t)n[i]=t[i];t.__esModule&&Object.defineProperty(n,"__esModule",{value:!0})})();