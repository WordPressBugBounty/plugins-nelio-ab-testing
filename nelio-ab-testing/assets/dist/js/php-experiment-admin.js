(()=>{var e,t={8247(e,t,n){"use strict";window.wp.coreData;const i=window.wp.domReady,r=n.n(i)(),a=window.nab.data,s=window.ReactJSXRuntime,o=window.wp.element,l=window.nab.experimentLibrary,d=window.wp.data;function c(e,t){return(0,d.useSelect)(e,t)}const p=window.nab.editor,b=window.wp.i18n;function u(e){var t,n,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e)if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=u(e[t]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n);return i}const g=function(){for(var e,t,n=0,i="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=u(e))&&(i&&(i+=" "),i+=t);return i},x=window.nab.utils,v=window.nab.components,h=({alternativeId:e})=>{const[t,n]=m(e),[i,r]=(0,o.useState)();return(0,s.jsx)("div",{className:"nab-php-editor-sidebar__editor",onClick:()=>null==i?void 0:i.focus(),children:(0,s.jsx)(v.CodeEditor,{language:"php",before:"<?php",value:t,onChange:n,readOnly:!1,onCreateEditor:r,placeholder:(0,b._x)("Write your PHP code here…","user","nelio-ab-testing")+"\n\n"+(0,b.sprintf)(/* translators: %1$s: Add_action. %2$s: Add_filter. */ /* translators: %1$s: Add_action. %2$s: Add_filter. */
(0,b._x)("We highly recommend using WordPress hooks like “%1$s” and “%2$s” to ensure a seamless integration with your setup.","text","nelio-ab-testing"),"add_action","add_filter")})})},m=e=>{var t;const n=c(t=>t(p.store).getAlternative(e),[e]),i=(null===(t=null==n?void 0:n.attributes)||void 0===t?void 0:t.snippet)||"",{setAlternative:r}=(0,d.useDispatch)(p.store);return[i,e=>{n&&r(n.id,Object.assign(Object.assign({},n),{attributes:(0,x.omitUndefineds)(Object.assign(Object.assign({},n.attributes),{validateSnippet:!0,snippet:e}))}))}]},_=({alternativeId:e})=>{const{type:t,message:n}=j(e);switch(t){case"error":return(0,s.jsx)("div",{className:"nab-php-editor-sidebar__error",children:(0,b.sprintf)(/* translators: %s: Error message. */ /* translators: %s: Error message. */
(0,b._x)("There’s a problem with your code: %s","text","nelio-ab-testing"),n)});case"warning":return(0,s.jsx)("div",{className:"nab-php-editor-sidebar__error",children:(0,b.sprintf)(/* translators: %s: Warning message. */ /* translators: %s: Warning message. */
(0,b._x)("There might be a problem with your code: %s","text","nelio-ab-testing"),n)});case"none":return null}},j=e=>{var t,n;const i=c(t=>t(p.store).getAlternative(e),[e]);return(null===(t=null==i?void 0:i.attributes)||void 0===t?void 0:t.errorMessage)?{type:"error",message:i.attributes.errorMessage}:(null===(n=null==i?void 0:i.attributes)||void 0===n?void 0:n.warningMessage)?{type:"warning",message:i.attributes.warningMessage}:{type:"none",message:""}},w=window.wp.components,f=(Object.assign(e=>(0,s.jsx)(w.BaseControl,Object.assign({__nextHasNoMarginBottom:!0},e)),w.BaseControl),Object.assign(e=>(0,s.jsx)(w.CheckboxControl,Object.assign({__nextHasNoMarginBottom:!0},e)),w.CheckboxControl),Object.assign(e=>(0,s.jsx)(w.FormTokenField,Object.assign({__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0},e)),w.FormTokenField),Object.assign(e=>(0,s.jsx)(w.RangeControl,Object.assign({__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0},e)),w.RangeControl),Object.assign(e=>(0,s.jsx)(w.TextControl,Object.assign({__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0},e)),w.TextControl),Object.assign(e=>(0,s.jsx)(w.TextareaControl,Object.assign({__nextHasNoMarginBottom:!0},e)),w.TextareaControl),Object.assign(e=>(0,s.jsx)(w.ToggleControl,Object.assign({__nextHasNoMarginBottom:!0},e)),w.ToggleControl),Object.assign(e=>(0,s.jsx)(w.__experimentalToggleGroupControl,Object.assign({__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0},e)),w.__experimentalToggleGroupControl),()=>{const e=C(),[t,n]=N();return(0,s.jsxs)("div",{className:"nab-php-editor-sidebar__actions",children:[(0,s.jsx)("div",{className:"nab-php-editor-sidebar__back-to-experiment",children:(0,s.jsx)("a",{className:"nab-php-editor-sidebar__back-to-experiment-link",href:e,title:(0,b._x)("Back to test…","command","nelio-ab-testing"),children:(0,s.jsx)(w.Dashicon,{icon:"arrow-left-alt2"})})}),(0,s.jsxs)("div",{className:"nab-php-editor-sidebar__save-info",children:[t&&(0,s.jsxs)("span",{className:"nab-php-editor-sidebar__saving-label",children:[(0,s.jsx)(w.Dashicon,{icon:"cloud"}),(0,b._x)("Saving…","text","nelio-ab-testing")]}),(0,s.jsx)(w.Button,{variant:"primary",disabled:t,onClick:()=>{n()},children:(0,b._x)("Save and Preview","command","nelio-ab-testing")})]})]})}),C=()=>c(e=>{var t;return null===(t=e(p.store).getExperimentAttribute("links"))||void 0===t?void 0:t.edit},[]),N=()=>{const e=c(e=>e(p.store).isExperimentBeingSaved(),[]),{saveExperiment:t}=(0,d.useDispatch)(p.store);return[e,t]},y=()=>{const[e,t]=(0,a.usePageAttribute)("php-preview/areControlsVisible",!0),[n,i]=(0,a.usePageAttribute)("php-preview/activeResolution","desktop");return(0,s.jsxs)("div",{className:"nab-php-editor-sidebar__footer-actions",children:[(0,s.jsx)("div",{className:g({"nab-php-editor-sidebar__visibility-toggle":!0,"nab-php-editor-sidebar__visibility-toggle--hide":!!e,"nab-php-editor-sidebar__visibility-toggle--show":!e}),children:(0,s.jsx)(w.Button,{variant:"link",onClick:()=>t(!e),children:e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(w.Dashicon,{icon:"admin-collapse"}),(0,s.jsx)("span",{className:"nab-php-editor-sidebar__visibility-toggle-label",children:(0,b._x)("Hide Controls","command","nelio-ab-testing")})]}):(0,s.jsx)(w.Dashicon,{icon:"admin-collapse"})})}),(0,s.jsxs)("div",{className:"nab-php-editor-sidebar__resolutions",children:[(0,s.jsx)("div",{className:g({"nab-php-editor-sidebar__resolution":!0,"nab-php-editor-sidebar__resolution--is-active":"desktop"===n}),children:(0,s.jsxs)(w.Button,{variant:"link",onClick:()=>i("desktop"),children:[(0,s.jsx)(w.Dashicon,{icon:"desktop"}),(0,s.jsx)("span",{className:"screen-reader-text",children:(0,b._x)("Enter desktop preview mode","command","nelio-ab-testing")})]})}),(0,s.jsx)("div",{className:g({"nab-php-editor-sidebar__resolution":!0,"nab-php-editor-sidebar__resolution--is-active":"tablet"===n}),children:(0,s.jsxs)(w.Button,{variant:"link",onClick:()=>i("tablet"),children:[(0,s.jsx)(w.Dashicon,{icon:"tablet"}),(0,s.jsx)("span",{className:"screen-reader-text",children:(0,b._x)("Enter tablet preview mode","command","nelio-ab-testing")})]})}),(0,s.jsx)("div",{className:g({"nab-php-editor-sidebar__resolution":!0,"nab-php-editor-sidebar__resolution--is-active":"mobile"===n}),children:(0,s.jsxs)(w.Button,{variant:"link",onClick:()=>i("mobile"),children:[(0,s.jsx)(w.Dashicon,{icon:"smartphone"}),(0,s.jsx)("span",{className:"screen-reader-text",children:(0,b._x)("Enter mobile preview mode","command","nelio-ab-testing")})]})})]})]})},O=({className:e,alternativeId:t})=>(0,s.jsxs)("div",{className:g(["nab-php-editor-sidebar",e]),children:[(0,s.jsx)(f,{}),(0,s.jsx)(h,{alternativeId:t}),(0,s.jsx)(_,{alternativeId:t}),(0,s.jsx)(y,{})]}),k=window.wp.compose,I=window.wp.url,P=({className:e,alternativeId:t})=>{const n=E(t),i=(0,k.useInstanceId)(P),[r]=(0,a.usePageAttribute)("php-preview/activeResolution","desktop");return D(i,n),(0,s.jsx)("div",{className:g([e,"nab-php-preview"]),children:(0,s.jsx)("iframe",{id:`nab-php-previewer__iframe-${i}`,className:g(["nab-php-preview__iframe",`nab-php-preview__iframe--${r}`]),title:(0,b._x)("PHP Preview","text","nelio-ab-testing"),src:n})})},D=(e,t)=>{const n=c(e=>e(p.store).isExperimentBeingSaved(),[]),i=c(e=>e(a.store).getPluginSetting("homeUrl"),[]);(0,o.useEffect)(()=>{var r;if(n||!t)return;const a=document.getElementById(`nab-php-previewer__iframe-${e}`);if(!(null===(r=null==a?void 0:a.contentWindow)||void 0===r?void 0:r.location.href))return;const s=a.contentWindow.location.href,o=(0,I.getQueryArg)(t,"timestamp"),l=(0,I.getQueryArg)(t,"nabnonce"),d=(0,x.getLocalUrlError)(s,i)?t:(0,I.addQueryArgs)(s,{timestamp:o,nabnonce:l});a.contentWindow.location.href=d},[i,e,n,t])},E=e=>c(t=>{const{getAlternative:n}=t(p.store),i=n(e);return null==i?void 0:i.links.preview},[e]),B="php-editor-sidebar-width",M=document.createElement("style");function T(e){e=isNaN(e)?320:e,e=Math.min(e,window.innerWidth-320),e=Math.max(e,320),M.textContent=`:root{--nab-php-editor-sidebar-width: ${e}px;}`,(0,x.setValue)(B,e)}r(()=>{document.head.appendChild(M),T(Number.parseInt((0,x.getValue)(B,"")))});const S=({alternativeId:e})=>{const[t]=(0,a.usePageAttribute)("php-preview/areControlsVisible",!0),n=(0,o.useRef)(null),[i,r]=(0,o.useState)(!1);return(0,s.jsxs)("div",{className:g({"nab-php-editor":!0,"nab-php-editor--is-dragging":i}),children:[(0,s.jsx)(O,{className:g({"nab-php-editor__sidebar":!0,"nab-php-editor__sidebar--is-collapsed":!t}),alternativeId:e}),(0,s.jsx)(A,{dividerRef:n,onDragStart:()=>r(!0),onDrag:T,onDragEnd:()=>r(!1),onDoubleClick:()=>{r(!0),setTimeout(()=>{M.textContent="",setTimeout(()=>r(!1),200),(0,x.clearValue)(B)},0)}}),(0,s.jsx)(P,{className:g({"nab-php-editor__preview":!0,"nab-php-editor__preview--is-fullscreen":!t}),alternativeId:e},"nab-php-editor__preview")]})},A=({dividerRef:e,onDragStart:t,onDrag:n,onDragEnd:i,onDoubleClick:r})=>(0,s.jsx)("div",{ref:e,className:"nab-php-editor__resizer",role:"separator","aria-orientation":"vertical","aria-label":(0,b._x)("Resize Editor","command","nelio-ab-testing"),tabIndex:0,onPointerDown:e=>{e.currentTarget.setPointerCapture(e.pointerId),null==t||t()},onPointerMove:e=>{e.currentTarget.hasPointerCapture(e.pointerId)&&(null==n||n(e.clientX))},onPointerUp:e=>{e.currentTarget.hasPointerCapture(e.pointerId)&&e.currentTarget.releasePointerCapture(e.pointerId),null==i||i()},onDoubleClick:r}),R=({experimentId:e,alternativeId:t})=>{const n=c(t=>t(a.store).getExperiment(e),[e]);return n?(0,s.jsx)(o.StrictMode,{children:(0,s.jsx)(p.EditorProvider,{experiment:n,children:(0,s.jsx)(S,{alternativeId:t})})}):null};var H;window.nab=Object.assign(Object.assign({},(H=window)&&"object"==typeof H&&"nab"in H?window.nab:{}),{initPhpEditorPage:function(e,t){(0,l.registerCoreExperiments)();const n=document.getElementById(e);if(!n)return;const{experimentId:i,alternativeId:r}=t;var a,d;a=(0,s.jsx)(R,{experimentId:i,alternativeId:r}),(d=n)&&(o.createRoot?(0,o.createRoot)(d).render(a):(0,o.render)(a,d))}})}},n={};function i(e){var r=n[e];if(void 0!==r)return r.exports;var a=n[e]={exports:{}};return t[e](a,a.exports,i),a.exports}e=[],i.O=(t,n,r,a)=>{if(!n){var s=1/0;for(c=0;c<e.length;c++){for(var[n,r,a]=e[c],o=!0,l=0;l<n.length;l++)(!1&a||s>=a)&&Object.keys(i.O).every(e=>i.O[e](n[l]))?n.splice(l--,1):(o=!1,a<s&&(s=a));if(o){e.splice(c--,1);var d=r();void 0!==d&&(t=d)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[n,r,a]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r=i.O(void 0,[2948],()=>i(8247));r=i.O(r);var a=nab="undefined"==typeof nab?{}:nab;for(var s in r)a[s]=r[s];r.__esModule&&Object.defineProperty(a,"__esModule",{value:!0})})();