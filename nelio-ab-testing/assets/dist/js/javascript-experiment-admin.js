(()=>{var e,t={3840:(e,t,a)=>{"use strict";a.r(t),window.wp.coreData,window.wp.domReady;const n=window.nab.data,r=window.wp.element,i=window.nab.experimentLibrary,o=window.wp.data,s=window.nab.editor,c=window.wp.compose,l=window.wp.url;var d=a(6942),v=a.n(d);const u=window.lodash,p=window.nab.utils,b=window.wp.components,m=window.wp.i18n;var f,_=function(e){var t=e.isSaving,a=e.save,n=g();return r.createElement("div",{className:"nab-javascript-editor-sidebar__actions"},r.createElement("div",{className:"nab-javascript-editor-sidebar__back-to-experiment"},r.createElement("a",{className:"nab-javascript-editor-sidebar__back-to-experiment-link",href:n,title:(0,m._x)("Back to test…","command","nelio-ab-testing")},r.createElement(b.Dashicon,{icon:"arrow-left-alt2"}))),r.createElement("div",{className:"nab-javascript-editor-sidebar__save-info"},t&&r.createElement("span",{className:"nab-javascript-editor-sidebar__saving-label"},r.createElement(b.Dashicon,{icon:"cloud"}),(0,m._x)("Saving…","text","nelio-ab-testing")),r.createElement(b.Button,{variant:"primary",disabled:t,onClick:a},(0,m._x)("Save and Preview","command","nelio-ab-testing"))))},g=function(){return(0,o.useSelect)((function(e){var t;return null===(t=e(s.STORE_NAME).getExperimentAttribute("links"))||void 0===t?void 0:t.edit}))},w=function(e){var t=e.value,a=e.onChange;return r.createElement("div",{className:"nab-javascript-editor-sidebar__editor"},r.createElement("textarea",{style:t?void 0:{whiteSpace:"pre-wrap"},placeholder:E,value:t,onChange:function(e){return a(e.target.value)},autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false"}),!!(0,u.trim)(t)&&!/\bdone\(\)/.test((0,u.trim)(t))&&r.createElement("div",{className:"nab-javascript-editor-sidebar__editor-error"},(0,m._x)("“done()” not found","user","nelio-ab-testing")))},E=[(0,m._x)("Write your JavaScript snippet here. Here are some useful tips:","user","nelio-ab-testing"),"\n","\n- ",(0,m.sprintf)(/* translators: variable name */ /* translators: variable name */
(0,m._x)("Declare global variable “%s”","text","nelio-ab-testing"),"abc"),"\n  window.abc = abc;","\n","\n- ",(0,m._x)("Run callback when dom is ready","text","nelio-ab-testing"),"\n  utils.domReady( callback );","\n","\n- ",(0,m._x)("Show variant:","text","nelio-ab-testing"),"\n  utils.showContent();","\n","\n- ",(0,m._x)("Show variant and track events","text","nelio-ab-testing"),"\n  done();"].join(""),j=function(){var e=(0,n.usePageAttribute)("javascript-preview/areControlsVisible",!0),t=e[0],a=e[1],i=(0,n.usePageAttribute)("javascript-preview/activeResolution","desktop"),o=i[0],s=i[1];return r.createElement("div",{className:"nab-javascript-editor-sidebar__footer-actions"},r.createElement("div",{className:v()({"nab-javascript-editor-sidebar__visibility-toggle":!0,"nab-javascript-editor-sidebar__visibility-toggle--hide":!!t,"nab-javascript-editor-sidebar__visibility-toggle--show":!t})},r.createElement(b.Button,{variant:"link",onClick:function(){return a(!t)}},t?r.createElement(r.Fragment,null,r.createElement(b.Dashicon,{icon:"admin-collapse"}),r.createElement("span",{className:"nab-javascript-editor-sidebar__visibility-toggle-label"},(0,m._x)("Hide Controls","command","nelio-ab-testing"))):r.createElement(b.Dashicon,{icon:"admin-collapse"}))),r.createElement("div",{className:"nab-javascript-editor-sidebar__resolutions"},r.createElement("div",{className:v()({"nab-javascript-editor-sidebar__resolution":!0,"nab-javascript-editor-sidebar__resolution--is-active":"desktop"===o})},r.createElement(b.Button,{variant:"link",onClick:function(){return s("desktop")}},r.createElement(b.Dashicon,{icon:"desktop"}),r.createElement("span",{className:"screen-reader-text"},(0,m._x)("Enter desktop preview mode","command","nelio-ab-testing")))),r.createElement("div",{className:v()({"nab-javascript-editor-sidebar__resolution":!0,"nab-javascript-editor-sidebar__resolution--is-active":"tablet"===o})},r.createElement(b.Button,{variant:"link",onClick:function(){return s("tablet")}},r.createElement(b.Dashicon,{icon:"tablet"}),r.createElement("span",{className:"screen-reader-text"},(0,m._x)("Enter tablet preview mode","command","nelio-ab-testing")))),r.createElement("div",{className:v()({"nab-javascript-editor-sidebar__resolution":!0,"nab-javascript-editor-sidebar__resolution--is-active":"mobile"===o})},r.createElement(b.Button,{variant:"link",onClick:function(){return s("mobile")}},r.createElement(b.Dashicon,{icon:"smartphone"}),r.createElement("span",{className:"screen-reader-text"},(0,m._x)("Enter mobile preview mode","command","nelio-ab-testing"))))))},h=function(){return h=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},h.apply(this,arguments)},y=function(e){var t=e.className,a=e.alternativeId,n=e.isSaving,i=e.save,o=x(a),s=o[0],c=o[1];return r.createElement("div",{className:v()(["nab-javascript-editor-sidebar",t])},r.createElement(_,{isSaving:n,save:i}),r.createElement(w,{value:s,onChange:c}),r.createElement(j,null))},x=function(e){var t,a=(0,o.useSelect)((function(t){return t(s.STORE_NAME).getAlternative(e)})),n=(null===(t=null==a?void 0:a.attributes)||void 0===t?void 0:t.code)||"",r=(0,o.useDispatch)(s.STORE_NAME).setAlternative;return[n,function(e){a&&r(a.id,h(h({},a),{attributes:(0,p.omitUndefineds)(h(h({},a.attributes),{code:e}))}))}]},S=function(e){var t,a=e.className,i=e.iframeId,o=e.isSaving,s=e.previewUrl,c=(0,n.usePageAttribute)("javascript-preview/activeResolution","desktop")[0];return r.createElement("div",{className:v()([a,"nab-javascript-preview"])},r.createElement("iframe",{id:i,className:v()((t={"nab-javascript-preview__iframe":!0},t["nab-javascript-preview__iframe--".concat(c)]=!0,t["nab-javascript-preview__iframe--is-saving"]=o,t)),title:(0,m._x)("JavaScript Preview","text","nelio-ab-testing"),src:s}))},N=function(e){var t=e.alternativeId,a=(0,c.useInstanceId)(N),i="nab-javascript-previewer__iframe-".concat(a),o=(0,n.usePageAttribute)("javascript-preview/areControlsVisible",!0)[0],s=O(t),l=k(),d=A(i),u=d[0],p=d[1];return r.createElement("div",{className:"nab-javascript-editor"},r.createElement(y,{className:v()({"nab-javascript-editor__sidebar":!0,"nab-javascript-editor__sidebar--is-collapsed":!o}),alternativeId:t,isSaving:u,save:p}),r.createElement(S,{key:"nab-javascript-editor__preview",className:v()({"nab-javascript-editor__preview":!0,"nab-javascript-editor__preview--is-fullscreen":!o}),iframeId:i,isSaving:u,previewUrl:l,value:s}))},O=function(e){return(0,o.useSelect)((function(t){var a,n;return(null===(n=null===(a=t(s.STORE_NAME).getAlternative(e))||void 0===a?void 0:a.attributes)||void 0===n?void 0:n.code)||""}))},k=function(){return(0,o.useSelect)((function(e){var t=(0,e(s.STORE_NAME).getAlternative)("control");if(t){var a=e(s.STORE_NAME),n=a.getAlternatives,r=a.getExperimentId,i=(0,l.getQueryArgs)(document.location.href).alternative||"",o=n(),c=r(),d=(0,u.indexOf)((0,u.map)(o,"id"),i),v=t.links&&t.links.preview||"/",p=(0,l.removeQueryArgs)(v,"nab-preview","experiment","alternative","timestamp","nabnonce");return(0,l.addQueryArgs)(p,{"nab-javascript-previewer":"".concat(c,":").concat(d)})}}))},A=function(e){var t=(0,o.useSelect)((function(e){return!!e(n.STORE_NAME).getPageAttribute("javascript-preview/isLoading")})),a=(0,o.useDispatch)(n.STORE_NAME).setPageAttribute,r=(0,o.useDispatch)(s.STORE_NAME).saveExperiment;return[t,function(){a("javascript-preview/isLoading",!0),r().then((function(){var t,n=document.getElementById(e);null===(t=null==n?void 0:n.contentWindow)||void 0===t||t.location.reload(),setTimeout((function(){return a("javascript-preview/isLoading",!1)}),5e3)}))}]},C=function(e){var t=e.experimentId,a=e.alternativeId,i=(0,o.useSelect)((function(e){return e(n.STORE_NAME).getExperiment(t)}));return i?r.createElement(r.StrictMode,null,r.createElement(s.EditorProvider,{experiment:i},r.createElement(N,{alternativeId:a}))):null},P=function(){return P=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},P.apply(this,arguments)};window.nab=P(P({},(f=window)&&"object"==typeof f&&"nab"in f?window.nab:{}),{initJavaScriptEditorPage:function(e,t){(0,i.registerCoreExperiments)();var a=document.getElementById(e);if(a){var n,o,s=t.experimentId,c=t.alternativeId;n=r.createElement(C,{experimentId:s,alternativeId:c}),(o=a)&&(r.createRoot?(0,r.createRoot)(o).render(n):(0,r.render)(n,o))}}})},6942:(e,t)=>{var a;!function(){"use strict";var n={}.hasOwnProperty;function r(){for(var e="",t=0;t<arguments.length;t++){var a=arguments[t];a&&(e=o(e,i(a)))}return e}function i(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return r.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var a in e)n.call(e,a)&&e[a]&&(t=o(t,a));return t}function o(e,t){return t?e?e+" "+t:e+t:e}e.exports?(r.default=r,e.exports=r):void 0===(a=function(){return r}.apply(t,[]))||(e.exports=a)}()}},a={};function n(e){var r=a[e];if(void 0!==r)return r.exports;var i=a[e]={exports:{}};return t[e](i,i.exports,n),i.exports}n.m=t,e=[],n.O=(t,a,r,i)=>{if(!a){var o=1/0;for(d=0;d<e.length;d++){for(var[a,r,i]=e[d],s=!0,c=0;c<a.length;c++)(!1&i||o>=i)&&Object.keys(n.O).every((e=>n.O[e](a[c])))?a.splice(c--,1):(s=!1,i<o&&(o=i));if(s){e.splice(d--,1);var l=r();void 0!==l&&(t=l)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[a,r,i]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={2676:0,1091:0};n.O.j=t=>0===e[t];var t=(t,a)=>{var r,i,[o,s,c]=a,l=0;if(o.some((t=>0!==e[t]))){for(r in s)n.o(s,r)&&(n.m[r]=s[r]);if(c)var d=c(n)}for(t&&t(a);l<o.length;l++)i=o[l],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(d)},a=globalThis.webpackChunknab=globalThis.webpackChunknab||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var r=n.O(void 0,[1091],(()=>n(3840)));r=n.O(r);var i=nab="undefined"==typeof nab?{}:nab;for(var o in r)i[o]=r[o];r.__esModule&&Object.defineProperty(i,"__esModule",{value:!0})})();