(()=>{var e,t={3639:(e,t,a)=>{"use strict";window.wp.coreData,window.wp.domReady;const n=window.nab.data,r=window.wp.element,i=window.nab.experimentLibrary,o=window.wp.data;function s(e,t){return(0,o.useSelect)(e,t)}const l=window.nab.editor,c=window.wp.compose,d=window.wp.url;var v=a(6942),u=a.n(v);const p=window.lodash,b=window.nab.utils,m=window.wp.components,f=window.wp.i18n;var g=function(e){var t=e.isSaving,a=e.save,n=w();return r.createElement("div",{className:"nab-javascript-editor-sidebar__actions"},r.createElement("div",{className:"nab-javascript-editor-sidebar__back-to-experiment"},r.createElement("a",{className:"nab-javascript-editor-sidebar__back-to-experiment-link",href:n,title:(0,f._x)("Back to test…","command","nelio-ab-testing")},r.createElement(m.Dashicon,{icon:"arrow-left-alt2"}))),r.createElement("div",{className:"nab-javascript-editor-sidebar__save-info"},t&&r.createElement("span",{className:"nab-javascript-editor-sidebar__saving-label"},r.createElement(m.Dashicon,{icon:"cloud"}),(0,f._x)("Saving…","text","nelio-ab-testing")),r.createElement(m.Button,{variant:"primary",disabled:t,onClick:a},(0,f._x)("Save and Preview","command","nelio-ab-testing"))))},w=function(){return s((function(e){var t;return null===(t=e(l.store).getExperimentAttribute("links"))||void 0===t?void 0:t.edit}))};const _=window.nab.components;var E,j=function(e,t,a){if(a||2===arguments.length)for(var n,r=0,i=t.length;r<i;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))},h=function(e){var t=e.value,a=e.onChange,n=e.globals;return r.createElement(_.CodeEditor,{className:"nab-javascript-editor-sidebar__editor",language:"javascript",placeholder:x,value:t,onChange:a,config:{globals:j(j([],n,!0),["utils","done"],!1)}})},x=[(0,f._x)("Write your JavaScript snippet here. Here are some useful tips:","user","nelio-ab-testing"),"\n","\n- ",(0,f.sprintf)(/* translators: variable name */ /* translators: variable name */
(0,f._x)("Declare global variable “%s”","text","nelio-ab-testing"),"abc"),"\n  window.abc = abc;","\n","\n- ",(0,f._x)("Run callback when dom is ready","text","nelio-ab-testing"),"\n  utils.domReady( callback );","\n","\n- ",(0,f._x)("Show variant:","text","nelio-ab-testing"),"\n  utils.showContent();","\n","\n- ",(0,f._x)("Show variant and track events","text","nelio-ab-testing"),"\n  done();"].join(""),y=function(){var e=(0,n.usePageAttribute)("javascript-preview/areControlsVisible",!0),t=e[0],a=e[1],i=(0,n.usePageAttribute)("javascript-preview/activeResolution","desktop"),o=i[0],s=i[1];return r.createElement("div",{className:"nab-javascript-editor-sidebar__footer-actions"},r.createElement("div",{className:u()({"nab-javascript-editor-sidebar__visibility-toggle":!0,"nab-javascript-editor-sidebar__visibility-toggle--hide":!!t,"nab-javascript-editor-sidebar__visibility-toggle--show":!t})},r.createElement(m.Button,{variant:"link",onClick:function(){return a(!t)}},t?r.createElement(r.Fragment,null,r.createElement(m.Dashicon,{icon:"admin-collapse"}),r.createElement("span",{className:"nab-javascript-editor-sidebar__visibility-toggle-label"},(0,f._x)("Hide Controls","command","nelio-ab-testing"))):r.createElement(m.Dashicon,{icon:"admin-collapse"}))),r.createElement("div",{className:"nab-javascript-editor-sidebar__resolutions"},r.createElement("div",{className:u()({"nab-javascript-editor-sidebar__resolution":!0,"nab-javascript-editor-sidebar__resolution--is-active":"desktop"===o})},r.createElement(m.Button,{variant:"link",onClick:function(){return s("desktop")}},r.createElement(m.Dashicon,{icon:"desktop"}),r.createElement("span",{className:"screen-reader-text"},(0,f._x)("Enter desktop preview mode","command","nelio-ab-testing")))),r.createElement("div",{className:u()({"nab-javascript-editor-sidebar__resolution":!0,"nab-javascript-editor-sidebar__resolution--is-active":"tablet"===o})},r.createElement(m.Button,{variant:"link",onClick:function(){return s("tablet")}},r.createElement(m.Dashicon,{icon:"tablet"}),r.createElement("span",{className:"screen-reader-text"},(0,f._x)("Enter tablet preview mode","command","nelio-ab-testing")))),r.createElement("div",{className:u()({"nab-javascript-editor-sidebar__resolution":!0,"nab-javascript-editor-sidebar__resolution--is-active":"mobile"===o})},r.createElement(m.Button,{variant:"link",onClick:function(){return s("mobile")}},r.createElement(m.Dashicon,{icon:"smartphone"}),r.createElement("span",{className:"screen-reader-text"},(0,f._x)("Enter mobile preview mode","command","nelio-ab-testing"))))))},k=function(){return k=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},k.apply(this,arguments)},N=function(e){var t=e.className,a=e.alternativeId,n=e.isSaving,i=e.save,o=e.editorGlobals,s=O(a),l=s[0],c=s[1];return r.createElement("div",{className:u()(["nab-javascript-editor-sidebar",t])},r.createElement(g,{isSaving:n,save:i}),r.createElement(h,{value:l,onChange:c,globals:o}),r.createElement(y,null))},O=function(e){var t,a=s((function(t){return t(l.store).getAlternative(e)})),n=(null===(t=null==a?void 0:a.attributes)||void 0===t?void 0:t.code)||"",r=(0,o.useDispatch)(l.store).setAlternative;return[n,function(e){a&&r(a.id,k(k({},a),{attributes:(0,b.omitUndefineds)(k(k({},a.attributes),{code:e}))}))}]},S=function(e){var t,a=e.className,i=e.iframeId,o=e.isSaving,s=e.previewUrl,l=(0,n.usePageAttribute)("javascript-preview/activeResolution","desktop")[0];return r.createElement("div",{className:u()([a,"nab-javascript-preview"])},r.createElement("iframe",{id:i,className:u()((t={"nab-javascript-preview__iframe":!0},t["nab-javascript-preview__iframe--".concat(l)]=!0,t["nab-javascript-preview__iframe--is-saving"]=o,t)),title:(0,f._x)("JavaScript Preview","text","nelio-ab-testing"),src:s}))},A=function(e){var t=e.alternativeId,a=e.editorGlobals,i=(0,c.useInstanceId)(A),o="nab-javascript-previewer__iframe-".concat(i),s=(0,n.usePageAttribute)("javascript-preview/areControlsVisible",!0)[0],l=I(t),d=C(),v=P(o),p=v[0],b=v[1];return r.createElement("div",{className:"nab-javascript-editor"},r.createElement(N,{className:u()({"nab-javascript-editor__sidebar":!0,"nab-javascript-editor__sidebar--is-collapsed":!s}),alternativeId:t,isSaving:p,save:b,editorGlobals:a}),r.createElement(S,{key:"nab-javascript-editor__preview",className:u()({"nab-javascript-editor__preview":!0,"nab-javascript-editor__preview--is-fullscreen":!s}),iframeId:o,isSaving:p,previewUrl:d,value:l}))},I=function(e){return s((function(t){var a,n;return(null===(n=null===(a=t(l.store).getAlternative(e))||void 0===a?void 0:a.attributes)||void 0===n?void 0:n.code)||""}))},C=function(){return s((function(e){var t=(0,e(l.store).getAlternative)("control");if(t){var a=e(l.store),n=a.getAlternatives,r=a.getExperimentId,i=(0,d.getQueryArgs)(document.location.href).alternative||"",o=n(),s=r(),c=(0,p.indexOf)((0,p.map)(o,"id"),i),v=t.links&&t.links.preview||"/",u=(0,d.removeQueryArgs)(v,"nab-preview","experiment","alternative","timestamp","nabnonce");return(0,d.addQueryArgs)(u,{"nab-javascript-previewer":"".concat(s,":").concat(c)})}}))},P=function(e){var t=s((function(e){return!!e(n.store).getPageAttribute("javascript-preview/isLoading")})),a=(0,o.useDispatch)(n.store).setPageAttribute,r=(0,o.useDispatch)(l.store).saveExperiment;return[t,function(){a("javascript-preview/isLoading",!0),r().then((function(){var t,n=document.getElementById(e);null===(t=null==n?void 0:n.contentWindow)||void 0===t||t.location.reload(),setTimeout((function(){return a("javascript-preview/isLoading",!1)}),5e3)}))}]},D=function(e){var t=e.experimentId,a=e.alternativeId,i=e.editorGlobals,o=s((function(e){return e(n.store).getExperiment(t)}));return o?r.createElement(r.StrictMode,null,r.createElement(l.EditorProvider,{experiment:o},r.createElement(A,{alternativeId:a,editorGlobals:i}))):null},B=function(){return B=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},B.apply(this,arguments)};window.nab=B(B({},(E=window)&&"object"==typeof E&&"nab"in E?window.nab:{}),{initJavaScriptEditorPage:function(e,t){(0,i.registerCoreExperiments)();var a=document.getElementById(e);if(a){var n,o,s=t.experimentId,l=t.alternativeId;n=r.createElement(D,{experimentId:s,alternativeId:l,editorGlobals:t.editorGlobals}),(o=a)&&(r.createRoot?(0,r.createRoot)(o).render(n):(0,r.render)(n,o))}}})},6942:(e,t)=>{var a;!function(){"use strict";var n={}.hasOwnProperty;function r(){for(var e="",t=0;t<arguments.length;t++){var a=arguments[t];a&&(e=o(e,i(a)))}return e}function i(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return r.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var a in e)n.call(e,a)&&e[a]&&(t=o(t,a));return t}function o(e,t){return t?e?e+" "+t:e+t:e}e.exports?(r.default=r,e.exports=r):void 0===(a=function(){return r}.apply(t,[]))||(e.exports=a)}()}},a={};function n(e){var r=a[e];if(void 0!==r)return r.exports;var i=a[e]={exports:{}};return t[e](i,i.exports,n),i.exports}n.m=t,e=[],n.O=(t,a,r,i)=>{if(!a){var o=1/0;for(d=0;d<e.length;d++){a=e[d][0],r=e[d][1],i=e[d][2];for(var s=!0,l=0;l<a.length;l++)(!1&i||o>=i)&&Object.keys(n.O).every((e=>n.O[e](a[l])))?a.splice(l--,1):(s=!1,i<o&&(o=i));if(s){e.splice(d--,1);var c=r();void 0!==c&&(t=c)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[a,r,i]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={2676:0,1091:0};n.O.j=t=>0===e[t];var t=(t,a)=>{var r,i,o=a[0],s=a[1],l=a[2],c=0;if(o.some((t=>0!==e[t]))){for(r in s)n.o(s,r)&&(n.m[r]=s[r]);if(l)var d=l(n)}for(t&&t(a);c<o.length;c++)i=o[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(d)},a=self.webpackChunknab=self.webpackChunknab||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var r=n.O(void 0,[1091],(()=>n(3639)));r=n.O(r);var i=nab="undefined"==typeof nab?{}:nab;for(var o in r)i[o]=r[o];r.__esModule&&Object.defineProperty(i,"__esModule",{value:!0})})();