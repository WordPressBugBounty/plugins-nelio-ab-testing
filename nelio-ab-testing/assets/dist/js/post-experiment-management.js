(()=>{var e,t={5447(e,t,n){"use strict";const i=window.nab.data,o=window.ReactJSXRuntime,a=window.wp.element,s=window.nab.experimentLibrary,r=window.wp.apiFetch;var l=n.n(r);const d=window.wp.date,c=window.wp.url,p=e=>{var t,n;return!!(null===(t=e.url)||void 0===t?void 0:t.includes("/wp-json/"))||!!(null===(n=e.url)||void 0===n?void 0:n.includes("rest_route"))||!!Object.keys(e).includes("rest_route")},x=window.wp.components,m=(Object.assign(e=>(0,o.jsx)(x.BaseControl,Object.assign({__nextHasNoMarginBottom:!0},e)),x.BaseControl),Object.assign(e=>(0,o.jsx)(x.CheckboxControl,Object.assign({__nextHasNoMarginBottom:!0},e)),x.CheckboxControl),Object.assign(e=>(0,o.jsx)(x.FormTokenField,Object.assign({__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0},e)),x.FormTokenField),Object.assign(e=>(0,o.jsx)(x.RangeControl,Object.assign({__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0},e)),x.RangeControl),e=>(0,o.jsx)(x.SelectControl,Object.assign({__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0},e))),g=(Object.assign(e=>(0,o.jsx)(x.TextControl,Object.assign({__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0},e)),x.TextControl),Object.assign(e=>(0,o.jsx)(x.TextareaControl,Object.assign({__nextHasNoMarginBottom:!0},e)),x.TextareaControl),Object.assign(e=>(0,o.jsx)(x.ToggleControl,Object.assign({__nextHasNoMarginBottom:!0},e)),x.ToggleControl),Object.assign(e=>(0,o.jsx)(x.__experimentalToggleGroupControl,Object.assign({__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0},e)),x.__experimentalToggleGroupControl),window.wp.data);function b(e,t){return(0,g.useSelect)(e,t)}const u=window.wp.i18n,_=window.lodash,j=window.nab.components,v=window.nab.experiments,w=window.nab.utils,h=({experimentId:e,postBeingEdited:t,type:n})=>{const i=E(e);return i?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(I,{icon:i,experimentId:e}),(0,o.jsx)(f,{experimentId:e,postBeingEdited:t}),(0,o.jsx)(O,{experimentId:e,postBeingEdited:t,type:n})]}):null},I=({icon:e,experimentId:t})=>{const n=C(t),i=B(t);return(0,o.jsxs)(x.PanelRow,{className:"nab-test-panel",children:[(0,o.jsx)("span",{className:"nab-test-panel__icon",children:(0,o.jsx)(e,{})}),(0,o.jsx)("a",{className:"nab-test-panel__name",href:i,children:n})]})},f=({experimentId:e,postBeingEdited:t})=>{const n=y(e);return n?(0,o.jsxs)(x.PanelRow,{className:"nab-variants-panel",children:[(0,o.jsx)("h2",{className:"nab-variants-panel__title",children:(0,u._x)("Variants","text","nelio-ab-testing")}),n.map(({name:e,link:n,postId:i,index:a})=>(0,o.jsxs)("div",{className:"nab-alternative",children:[(0,o.jsx)("span",{className:"nab-alternative__letter",children:(0,w.getLetter)(a)}),(0,o.jsx)("span",{className:"nab-alternative__name",children:t!==i?(0,o.jsx)("a",{href:n,children:F(e,a)}):(0,o.jsx)("strong",{children:F(e,a)})})]},i))]}):null},O=({experimentId:e,postBeingEdited:t,type:n})=>{var i,s;const[r,l]=N(t),d=T(e,t),c=null!==(s=null===(i=d[0])||void 0===i?void 0:i.value)&&void 0!==s?s:0,[p,g]=(0,a.useState)({isConfirmationDialogVisible:!1,isImportEnabled:!1,postIdToImportFrom:c,variantToImportFrom:c}),b=e=>g(Object.assign(Object.assign({},p),e)),{isImportEnabled:_,isConfirmationDialogVisible:v,postIdToImportFrom:w,variantToImportFrom:h}=p;if(h<0)return null;const I=()=>b({isImportEnabled:!_}),f=()=>b({isConfirmationDialogVisible:!v});return _?(0,o.jsxs)(x.PanelRow,{className:"nab-content-panel",children:[(0,o.jsx)("h2",{className:"nab-content-panel__title",children:(0,u._x)("Content","text","nelio-ab-testing")}),(0,o.jsx)(m,{label:(0,u._x)("Import content from:","text","nelio-ab-testing"),options:d.map(e=>Object.assign(Object.assign({},e),{value:`${e.value}`})),value:`${h}`,onChange:e=>{var t;t=Number.parseInt(e)||0,b({variantToImportFrom:t,postIdToImportFrom:t})}}),0===h&&(0,o.jsx)(j.PostSearcher,{value:w,className:"nab-content-panel__searcher",type:n,onChange:(e=0)=>b({variantToImportFrom:0,postIdToImportFrom:e}),menuPlacement:"auto",menuShouldBlockScroll:!0}),(0,o.jsxs)("div",{className:"nab-content-panel__actions",children:[(0,o.jsx)(x.Button,{variant:"link",onClick:I,children:(0,u._x)("Cancel","command","nelio-ab-testing")}),(0,o.jsx)(x.Button,{variant:"secondary",disabled:!w,onClick:f,children:(0,u._x)("Import","command","nelio-ab-testing")}),(0,o.jsx)(j.ConfirmationDialog,{title:(0,u._x)("Import Content?","text","nelio-ab-testing"),text:(0,u._x)("This will overwrite the current content.","text","nelio-ab-testing"),confirmLabel:r?(0,u._x)("Importing…","text","nelio-ab-testing"):(0,u._x)("Import","command","nelio-ab-testing"),isConfirmEnabled:!r,isCancelEnabled:!r,isOpen:v,onCancel:f,onConfirm:()=>l(w)})]})]}):(0,o.jsxs)(x.PanelRow,{className:"nab-content-panel",children:[(0,o.jsx)("h2",{className:"nab-content-panel__title",children:(0,u._x)("Content","text","nelio-ab-testing")}),(0,o.jsxs)("span",{className:"nab-content-panel__label",children:[(0,o.jsx)(x.Dashicon,{icon:"admin-page"}),(0,o.jsx)(x.Button,{variant:"link",onClick:I,children:(0,u._x)("Import Content","command","nelio-ab-testing")})]})]})},C=e=>b(t=>{var n;return(null===(n=t(i.store).getExperiment(e))||void 0===n?void 0:n.name)||(0,u._x)("Unnamed Test","text","nelio-ab-testing")},[e]),B=e=>b(t=>{var n;return(null===(n=t(i.store).getExperiment(e))||void 0===n?void 0:n.links.edit)||""},[e]),y=e=>{const t=b(t=>{var n;return null===(n=t(i.store).getExperiment(e))||void 0===n?void 0:n.alternatives},[e]);return(0,_.map)(t,(e,t)=>({index:t,postId:P(e)?e.attributes.postId:0,name:k(e)?e.attributes.name:"",link:e.links.edit}))},E=e=>b(t=>{var n,a,s,r;const{getExperiment:l}=t(i.store),{getExperimentTypes:d}=t(v.store),c=null!==(a=null===(n=l(e))||void 0===n?void 0:n.type)&&void 0!==a?a:"";return null!==(r=null===(s=d()[c])||void 0===s?void 0:s.icon)&&void 0!==r?r:()=>(0,o.jsx)(o.Fragment,{})},[e]),N=e=>{const[t,n]=(0,a.useState)(!1);return[t,i=>{i&&(t||(n(!0),(e=>{const{url:t,path:n}=e,i=(0,d.format)("YmjHi").substring(0,11)+"0";return l()(Object.assign(Object.assign(Object.assign(Object.assign({},e),t&&{url:p(e)?(0,c.addQueryArgs)(t,{nabts:i}):t}),n&&{path:(0,c.addQueryArgs)(n,{nabts:i})}),{parse:!0}))})({path:`/nab/v1/post/${i}/overwrites/${e}`,method:"PUT"}).finally(()=>{window.location.reload()})))}]},T=(e,t)=>[...y(e).map((e,n)=>t===e.postId?void 0:{label:(0,u.sprintf)(/* translators: %s: Variant letter. */ /* translators: %s: Variant letter. */
(0,u._x)("Variant %s","text","nelio-ab-testing"),(0,w.getLetter)(n)),value:e.postId}).filter(w.isDefined),{label:(0,u._x)("Other…","text","nelio-ab-testing"),value:0}],P=e=>!!e.attributes.postId,k=e=>!!e.attributes.name,F=(e,t)=>e||(0===t?(0,u._x)("Control Version","text","nelio-ab-testing"):(0,u.sprintf)(/* translators: %s: Letter, such as A, B, or C. */ /* translators: %s: Letter, such as A, B, or C. */
(0,u._x)("Variant %s","text","nelio-ab-testing"),(0,w.getLetter)(t))),S=window.wp.editPost,D=window.wp.plugins,M=S.PluginDocumentSettingPanel?({experimentId:e,postBeingEdited:t,type:n})=>(0,o.jsx)(S.PluginDocumentSettingPanel,{className:"nab-alternative-editing-sidebar",title:"Nelio A/B Testing",children:(0,o.jsx)(h,{experimentId:e,postBeingEdited:t,type:n})}):()=>null;var H;window.nab=Object.assign(Object.assign({},(H=window)&&"object"==typeof H&&"nab"in H?window.nab:{}),{initEditPostAlternativeMetabox:function(e){(0,s.registerCoreExperiments)();const{experimentId:t,postBeingEdited:n,type:i}=e,r=document.getElementById("nelioab_edit_post_alternative_box"),l=null==r?void 0:r.getElementsByClassName("inside")[0];var d,c;l&&(d=(0,o.jsx)(h,{experimentId:t,postBeingEdited:n,type:i}),(c=l)&&(a.createRoot?(0,a.createRoot)(c).render(d):(0,a.render)(d,c)))},initEditPostAlternativeBlockEditorSidebar:function(e){(0,s.registerCoreExperiments)();const{experimentId:t,postBeingEdited:n,type:i}=e;(0,D.registerPlugin)("nelio-ab-testing",{icon:()=>(0,o.jsx)(o.Fragment,{}),render:()=>(0,o.jsx)(M,{experimentId:t,postBeingEdited:n,type:i})})}})}},n={};function i(e){var o=n[e];if(void 0!==o)return o.exports;var a=n[e]={exports:{}};return t[e](a,a.exports,i),a.exports}e=[],i.O=(t,n,o,a)=>{if(!n){var s=1/0;for(c=0;c<e.length;c++){for(var[n,o,a]=e[c],r=!0,l=0;l<n.length;l++)(!1&a||s>=a)&&Object.keys(i.O).every(e=>i.O[e](n[l]))?n.splice(l--,1):(r=!1,a<s&&(s=a));if(r){e.splice(c--,1);var d=o();void 0!==d&&(t=d)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[n,o,a]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var o=i.O(void 0,[904],()=>i(5447));o=i.O(o);var a=nab="undefined"==typeof nab?{}:nab;for(var s in o)a[s]=o[s];o.__esModule&&Object.defineProperty(a,"__esModule",{value:!0})})();