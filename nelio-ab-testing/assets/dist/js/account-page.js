(()=>{var e,n={8409(e,n,t){"use strict";t.r(n),t.d(n,{initPage:()=>pt});var i={};t.r(i),t.d(i,{getAccount:()=>N,getCurrency:()=>W,getDeactivationDate:()=>q,getEmail:()=>F,getExtraQuotaUnits:()=>V,getFirstname:()=>P,getFullname:()=>D,getInvoices:()=>C,getLastname:()=>I,getLicense:()=>B,getMode:()=>$,getNextChargeDate:()=>H,getNextChargeTotal:()=>G,getPeriod:()=>Q,getPhoto:()=>R,getPlan:()=>M,getProductDisplay:()=>U,getSite:()=>S,getSites:()=>w,getSitesAllowed:()=>K,getStartDate:()=>L,getState:()=>Y,getSubscriptionAddons:()=>k,getSubscriptionId:()=>A,getSubscriptionProduct:()=>T,getSubscriptionQuota:()=>O,getUrlToManagePayments:()=>z,isAgency:()=>J,isAgencyFullViewEnabled:()=>Z,isLocked:()=>X,isSubscriptionDeprecated:()=>E});var a={};t.r(a),t.d(a,{enableAgencyFullView:()=>te,lock:()=>ee,receiveAccount:()=>ie,receiveInvoices:()=>se,receiveSites:()=>ae,removeSiteAfterUnlink:()=>oe,unlock:()=>ne});var s={};t.r(s),t.d(s,{cancelSubscription:()=>xe,limitSiteQuota:()=>je,linkSite:()=>ge,uncancelSubscription:()=>he,unlinkSite:()=>me,upgradeSubscription:()=>_e});var o={};t.r(o),t.d(o,{getAccount:()=>ve,getInvoices:()=>we,getSites:()=>Ne,getSubscriptionQuota:()=>ye});const r=window.ReactJSXRuntime,c=(window.wp.domReady,window.wp.notices),l=window.wp.components,d=(Object.assign(e=>(0,r.jsx)(l.BaseControl,Object.assign({__nextHasNoMarginBottom:!0},e)),l.BaseControl),Object.assign(e=>(0,r.jsx)(l.CheckboxControl,Object.assign({__nextHasNoMarginBottom:!0},e)),l.CheckboxControl)),u=(Object.assign(e=>(0,r.jsx)(l.FormTokenField,Object.assign({__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0},e)),l.FormTokenField),Object.assign(e=>(0,r.jsx)(l.RangeControl,Object.assign({__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0},e)),l.RangeControl),e=>(0,r.jsx)(l.SelectControl,Object.assign({__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0},e))),b=Object.assign(e=>(0,r.jsx)(l.TextControl,Object.assign({__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0},e)),l.TextControl),p=(Object.assign(e=>(0,r.jsx)(l.TextareaControl,Object.assign({__nextHasNoMarginBottom:!0},e)),l.TextareaControl),Object.assign(e=>(0,r.jsx)(l.ToggleControl,Object.assign({__nextHasNoMarginBottom:!0},e)),l.ToggleControl),Object.assign(e=>(0,r.jsx)(l.__experimentalToggleGroupControl,Object.assign({__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0},e)),l.__experimentalToggleGroupControl),window.wp.element),g=window.wp.i18n,m=window.nab.components,x=[{label:(0,g._x)("How do I change my payment details?","text","nelio-ab-testing"),link:"https://neliosoftware.com/testing/help/how-do-i-change-my-payment-details/"},{label:(0,g._x)("What if my monthly quota of page views gets exhausted?","text","nelio-ab-testing"),link:"https://neliosoftware.com/testing/help/what-if-my-monthly-quota-gets-exhausted/"}],h=({isSubscribed:e,siteId:n})=>(0,r.jsxs)("h1",{className:"wp-heading-inline nelio-ab-testing-page-title",children:[(0,r.jsx)("span",{children:e?(0,g._x)("Account Details","text","nelio-ab-testing"):(0,g._x)("Upgrade to Nelio A/B Testing Premium","user","nelio-ab-testing")}),(0,r.jsxs)("span",{className:"nelio-ab-testing-page-title__support-key",children:[(0,r.jsx)("strong",{children:(0,g._x)("Support Key:","text","nelio-ab-testing")}),(0,r.jsx)("code",{children:n}),(0,r.jsx)(m.ClipboardButton,{text:n})]})]}),_=window.wp.data;function j(e,n){return(0,_.useSelect)(e,n)}const f=window.lodash,v={account:{currency:"USD",deactivationDate:"",email:"",firstname:"",fullname:"",isAgency:!1,lastname:"",license:"",mode:"free",nextChargeDate:"",nextChargeTotal:"",period:"month",photo:"",plan:"free",productDisplay:"",productId:"",quota:500,quotaExtra:0,quotaPerMonth:0,sitesAllowed:1,startDate:"",state:"active",subscription:"",addons:[],addonDetails:{},urlToManagePayments:""},invoices:[],sites:[],isPageLocked:!1,isAgencyFullViewEnabled:!1},y=window.nab.utils;function N(e){return e.account}function w(e,n){return n?e.sites:y.EMPTY_ARRAY}function S(e,n){return(0,f.find)(e.sites,{id:n})}function C(e,n){return n?e.invoices:y.EMPTY_ARRAY}const O=(0,_.createSelector)(e=>{const{quota:n,quotaExtra:t,quotaPerMonth:i}=e.account,a=n+t;return{mode:"subscription",availableQuota:a,percentage:Math.floor(100*(a+.1)/i)}},e=>[e.account]);function A(e){return e.account.subscription}function k(e){return e.account.addons||y.EMPTY_ARRAY}function E(e){return!!e.account.subscription.startsWith("OL")}function D(e){return e.account.fullname}function P(e){return e.account.firstname}function I(e){return e.account.lastname}function F(e){return e.account.email}function L(e){return e.account.startDate}function T(e){return e.account.productId}function M(e){return e.account.plan}function B(e){return e.account.license}function R(e){return e.account.photo}function U(e){return e.account.productDisplay}function $(e){return e.account.mode}function Q(e){return e.account.period}function V(e){var n,t;return null!==(t=null!==(n=e.account.addonDetails["nab-pageviews-monthly"])&&void 0!==n?n:e.account.addonDetails["nab-pageviews-yearly"])&&void 0!==t?t:0}function Y(e){return e.account.state}function q(e){return e.account.deactivationDate}function H(e){return e.account.nextChargeDate}function G(e){return e.account.nextChargeTotal}function K(e){return e.account.sitesAllowed}function W(e){return e.account.currency}function z(e){return e.account.urlToManagePayments}function J(e){return!!e.account.isAgency}function X(e){return!!e.isPageLocked}function Z(e){return J(e)&&!!e.isAgencyFullViewEnabled}function ee(){return{type:"LOCK_PAGE"}}function ne(){return{type:"UNLOCK_PAGE"}}function te(){return{type:"ENABLE_AGENCY_FULL_VIEW"}}function ie(e){return{type:"RECEIVE_ACCOUNT",account:e}}function ae(e){return{type:"RECEIVE_SITES",sites:(0,f.castArray)(e)}}function se(e){return{type:"RECEIVE_INVOICES",invoices:(0,f.castArray)(e)}}function oe(e){return{type:"UNLINK_SITE",id:e}}const re=window.wp.apiFetch;var ce=t.n(re);const le=window.wp.date,de=window.wp.url,ue=e=>{const{url:n,path:t}=e,i=(0,le.format)("YmjHi").substring(0,11)+"0";return ce()(Object.assign(Object.assign(Object.assign(Object.assign({},e),n&&{url:be(e)?(0,de.addQueryArgs)(n,{nabts:i}):n}),t&&{path:(0,de.addQueryArgs)(t,{nabts:i})}),{parse:!0}))},be=e=>{var n,t;return!!(null===(n=e.url)||void 0===n?void 0:n.includes("/wp-json/"))||!!(null===(t=e.url)||void 0===t?void 0:t.includes("rest_route"))||!!Object.keys(e).includes("rest_route")};var pe=function(e,n,t,i){return new(t||(t=Promise))(function(a,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function r(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(o,r)}c((i=i.apply(e,n||[])).next())})};function ge(e){return pe(this,void 0,void 0,function*(){try{yield(0,_.dispatch)(Ce).lock(),yield ue({path:"/nab/v1/site/subscription",method:"POST",data:{license:e}}),window.location.reload()}catch(e){yield(0,_.dispatch)(Ce).unlock(),yield(0,y.createErrorNotice)(e)}})}function me(e){return pe(this,void 0,void 0,function*(){try{yield(0,_.dispatch)(Ce).lock(),yield ue({path:`/nab/v1/site/${e}/subscription`,method:"DELETE"});const n=(0,_.select)(Ce).getSite(e);if(null==n?void 0:n.isCurrentSite)return void window.location.reload();yield(0,_.dispatch)(Ce).unlock(),yield(0,_.dispatch)(Ce).removeSiteAfterUnlink(e)}catch(e){yield(0,_.dispatch)(Ce).unlock(),yield(0,y.createErrorNotice)(e)}})}function xe(){return pe(this,void 0,void 0,function*(){try{yield(0,_.dispatch)(Ce).lock();const e=(0,_.select)(Ce).getSubscriptionId();yield ue({path:`/nab/v1/subscription/${e}`,method:"DELETE"}),window.location.reload()}catch(e){yield(0,_.dispatch)(Ce).unlock(),yield(0,y.createErrorNotice)(e)}})}function he(){return pe(this,void 0,void 0,function*(){try{yield(0,_.dispatch)(Ce).lock();const e=(0,_.select)(Ce).getSubscriptionId();yield ue({path:`/nab/v1/subscription/${e}/uncancel`,method:"POST"}),window.location.reload()}catch(e){yield(0,_.dispatch)(Ce).unlock(),yield(0,y.createErrorNotice)(e)}})}function _e(e,n){return pe(this,void 0,void 0,function*(){try{yield(0,_.dispatch)(Ce).lock();const t=(0,_.select)(Ce).getSubscriptionId();yield ue({path:`/nab/v1/subscription/${t}`,method:"PUT",data:{product:e,extraQuotaUnits:n}}),window.location.reload()}catch(e){yield(0,_.dispatch)(Ce).unlock(),yield(0,y.createErrorNotice)(e)}})}function je(e,n){return pe(this,void 0,void 0,function*(){try{const t=(0,_.select)(Ce).getSubscriptionId(),i=(0,_.select)(Ce).getSites(t),a=yield ue({path:`/nab/v1/site/${e}`,method:"PUT",data:{maxMonthlyQuota:n}});yield(0,_.dispatch)(Ce).receiveSites(i.map(e=>e.id===a.id?Object.assign(Object.assign(Object.assign({},e),a),{maxMonthlyQuota:n}):e))}catch(e){yield(0,y.createErrorNotice)(e)}})}var fe=function(e,n,t,i){return new(t||(t=Promise))(function(a,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function r(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(o,r)}c((i=i.apply(e,n||[])).next())})};function ve(){return fe(this,void 0,void 0,function*(){try{const e=yield ue({path:"/nab/v1/account"});yield(0,_.dispatch)(Ce).receiveAccount(e)}catch(e){throw yield(0,y.createErrorNotice)(e,(0,g._x)("Error while accessing site info.","text","nelio-ab-testing")),e}})}function ye(){return fe(this,void 0,void 0,function*(){var e;yield(e=Ce,(0,_.resolveSelect)(e)).getAccount()})}function Ne(e){return fe(this,void 0,void 0,function*(){if(e)try{const n=yield ue({path:`/nab/v1/subscription/${e}/sites`});yield(0,_.dispatch)(Ce).receiveSites(n)}catch(n){throw yield(0,y.createErrorNotice)(n,(0,g.sprintf)(/* translators: %s: Subscription id. */ /* translators: %s: Subscription id. */
(0,g._x)("Error while accessing sites in subscription %s.","text","nelio-ab-testing"),e)),n}})}function we(e){return fe(this,void 0,void 0,function*(){if(e)try{const n=yield ue({path:`/nab/v1/subscription/${e}/invoices`});yield(0,_.dispatch)(Ce).receiveInvoices(n)}catch(n){throw yield(0,y.createErrorNotice)(n,(0,g.sprintf)(/* translators: %s: Subscription id. */ /* translators: %s: Subscription id. */
(0,g._x)("Error while accessing invoices in subscription %s.","text","nelio-ab-testing"),e)),n}})}const Se=Object.assign(Object.assign({},a),s),Ce=(0,_.createReduxStore)("nab/account",{reducer:function(e=v,n){var t;return null!==(t=function(e,n){switch(n.type){case"RECEIVE_ACCOUNT":return Object.assign(Object.assign({},e),{account:n.account});case"RECEIVE_INVOICES":return Object.assign(Object.assign({},e),{invoices:n.invoices});case"RECEIVE_SITES":return Object.assign(Object.assign({},e),{sites:n.sites});case"UNLINK_SITE":return Object.assign(Object.assign({},e),{sites:(0,f.reject)(e.sites,{id:n.id})});case"LOCK_PAGE":return Object.assign(Object.assign({},e),{isPageLocked:!0});case"UNLOCK_PAGE":return Object.assign(Object.assign({},e),{isPageLocked:!1});case"ENABLE_AGENCY_FULL_VIEW":return Object.assign(Object.assign({},e),{isAgencyFullViewEnabled:!0})}}(e,n))&&void 0!==t?t:e},controls:_.controls,actions:Se,selectors:i,resolvers:o});!function(e){(0,_.register)(e)}(Ce);const Oe=({children:e})=>{const n=Ae(),t=ke(),i=Ee(),{removeNotice:a}=(0,_.useDispatch)(c.store);return n?(0,r.jsx)(m.LoadingAnimation,{text:(0,g._x)("Loading…","text","nelio-ab-testing")}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.NoticeList,{notices:i,className:"components-editor-notices__pinned",onRemove:a}),!t&&e]})},Ae=()=>j(e=>(e(Ce).getAccount(),!e(Ce).hasFinishedResolution("getAccount")),[]),ke=()=>j(e=>e(Ce).hasResolutionFailed("getAccount"),[]),Ee=()=>j(e=>e(c.store).getNotices(),[]),De=window.nab.data,Pe=window.nab.date,Ie=({siteId:e})=>{const n=j(e=>e(Ce).getProductDisplay(),[]);return(0,r.jsxs)("div",{className:"nab-account-container__box nab-plan",children:[(0,r.jsxs)("div",{className:"nab-plan__content",children:[(0,r.jsxs)("h3",{className:"nab-plan__title",children:[n,(0,r.jsx)("span",{className:"nab-plan__period",children:(0,g._x)("Agency Plan","text","nelio-ab-testing")})]}),(0,r.jsx)("div",{className:"nab-plan__renewal",children:(0,g._x)("You’re currently using an agency subscription plan.","user","nelio-ab-testing")}),(0,r.jsx)(m.QuotaMeter,{})]}),(0,r.jsxs)("div",{className:"nab-plan__actions",children:[(0,r.jsx)(Fe,{siteId:e}),(0,r.jsx)(Le,{})]})]})},Fe=({siteId:e})=>{const[n,t]=(0,p.useState)(!1),{unlinkSite:i}=(0,_.useDispatch)(Ce),a=()=>t(!1);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.Button,{isDestructive:!0,className:"nab-plan__action",onClick:()=>t(!0),children:(0,g._x)("Downgrade to Free Version","command","nelio-ab-testing")}),(0,r.jsx)(m.ConfirmationDialog,{title:(0,g._x)("Downgrade to Free version?","text","nelio-ab-testing"),text:(0,g._x)("This will remove the subscription license from the site and you’ll be using Nelio A/B Testing’s free version.","text","nelio-ab-testing"),confirmLabel:(0,g._x)("Downgrade","command","nelio-ab-testing"),isOpen:n,onCancel:a,onConfirm:()=>{a(),i(e)}})]})},Le=()=>{const[e,n]=(0,p.useState)(!1),[t,i]=(0,p.useState)(""),[a,s]=(0,p.useState)(!1),{enableAgencyFullView:o,receiveAccount:c}=(0,_.useDispatch)(Ce);return(0,r.jsxs)("div",{children:[(0,r.jsx)(l.Button,{variant:"secondary",className:"nab-plan__action",onClick:()=>n(!0),children:(0,g._x)("View Details","command","nelio-ab-testing")}),e&&(0,r.jsxs)(l.Popover,{className:"nab-license-form",noArrow:!1,placement:"bottom",children:[(0,r.jsx)(b,{value:t,placeholder:(0,g._x)("Type your license here","user","nelio-ab-testing"),className:"nab-license-form__text-control",onChange:e=>i((0,f.trim)(e))}),(0,r.jsx)(l.Button,{variant:"primary",isBusy:a,className:"nab-license-form__button",onClick:()=>{s(!0),ue({path:"/nab/v1/account/agency",method:"POST",data:{license:t}}).then(e=>{c(e),o(),s(!1),n(!1)}).catch(()=>{s(!1)})},disabled:!t.length||a,children:a?(0,g._x)("Validating…","text","nelio-ab-testing"):(0,g._x)("Validate","command","nelio-ab-testing")})]})]})},Te=({isOpen:e,placement:n,onFocusOutside:t})=>{const i=Me(),{addons:a,enabledAddons:s}=Be(),[o,c]=(0,p.useState)(!1),[d,u]=(0,p.useState)(),b=Re(),x=j(e=>e(Ce).isLocked(),[]),{lock:h,unlock:f}=(0,_.useDispatch)(Ce);if(o){if(!d)return null;const{displayName:e,displayPrice:n}=d;return(0,r.jsx)(m.ConfirmationDialog,{title:(0,g.sprintf)(/* translators: %s: Addon name. */ /* translators: %s: Addon name. */
(0,g._x)("Upgrade your subscription to include %s?","text","nelio-ab-testing"),e),text:(0,p.createInterpolateElement)((0,g.sprintf)(/* translators: %1$s: Addon name. %2$s: Addon price. */ /* translators: %1$s: Addon name. %2$s: Addon price. */
(0,g._x)("This will include the %1$s addon to your subscription for an additional charge of %2$s. You will be charged today.","text","nelio-ab-testing"),e,`<strong>${n}</strong>`),{strong:(0,r.jsx)("strong",{})}),confirmLabel:(0,g._x)("Upgrade Now","command","nelio-ab-testing"),isOpen:o,isConfirmBusy:x,onCancel:()=>c(!1),onConfirm:()=>{h(),ue({path:"/nab/v1/activate/recordings",method:"POST"}).then(()=>window.location.reload()).catch(e=>(0,y.createErrorNotice)(e)).finally(()=>{f(),u(void 0),c(!1)})}})}return e?i?(0,r.jsx)(l.Popover,{className:"nab-addons nab-addons--loading",noArrow:!1,placement:n,onFocusOutside:t,children:(0,r.jsx)(l.Spinner,{})}):(0,r.jsx)(l.Popover,{className:"nab-addons",noArrow:!1,placement:n,onFocusOutside:t,children:(0,r.jsxs)("div",{className:"nab-addons__container",children:[(0,r.jsx)("div",{className:"nab-addons__container-title",children:(0,g._x)("Addons","text","nelio-ab-testing")}),(0,r.jsx)("div",{className:"nab-addons__container-list",children:a.map(({id:e,displayName:n,price:t,period:i})=>(0,r.jsxs)("div",{className:"nab-addons__product",children:[(0,r.jsxs)("div",{className:"nab-addons__product-details",children:[(0,r.jsx)("div",{className:"nab-addons__product-name",children:$e(n)}),!s.includes(e)&&(0,r.jsx)("div",{className:"nab-addons__product-price",title:b,children:Ue(t[b]||0,b,i)})]}),(0,r.jsx)("div",{className:"nab-addons__product-action",children:s.includes(e)?(0,r.jsx)("span",{className:"nab-addons__product--enabled",children:(0,g._x)("Enabled","text","nelio-ab-testing")}):(0,r.jsx)(l.Button,{variant:"primary",disabled:x,isBusy:x,onClick:()=>{u({displayName:$e(n),displayPrice:Ue(t[b]||0,b,i)}),c(!0)},children:(0,g._x)("Enable","text","nelio-ab-testing")})})]},e))}),(0,r.jsx)(l.Button,{className:"screen-reader-text",onClick:t,children:(0,g._x)("Close addons","command","nelio-ab-testing")})]})}):null},Me=()=>j(e=>!e(De.store).hasFinishedResolution("getProducts"),[]),Be=()=>{const e=j(e=>{var n;const{getProducts:t}=e(De.store),{getSubscriptionProduct:i,getSubscriptionAddons:a}=e(Ce),s=i(),o=a(),r=t(),c=(null===(n=r.find(e=>e.id===s))||void 0===n?void 0:n.allowedAddons)||y.EMPTY_ARRAY;return{products:r,allowedAddons:c,enabledAddons:o}},[]);return{addons:e.products.filter(n=>n.isAddon&&e.allowedAddons.includes(n.id)),enabledAddons:e.enabledAddons}},Re=()=>j(e=>e(Ce).getCurrency()||"USD",[]),Ue=(e,n,t)=>`${"EUR"===n?`${e}€`:`US$${e}`} ${"month"===t?(0,g._x)("/ month","text","nelio-ab-testing"):(0,g._x)("/ year","text","nelio-ab-testing")}`.trim(),$e=e=>(0,Pe.getLocale)().startsWith("es")?e.es:e.en,Qe=({isOpen:e,placement:n,onClick:t,onFocusOutside:i})=>{const[a,s]=(0,p.useState)(""),{linkSite:o}=(0,_.useDispatch)(Ce);return e?(0,r.jsxs)(l.Popover,{className:"nab-license-form",noArrow:!1,placement:n,onFocusOutside:i,children:[(0,r.jsx)(b,{value:a,placeholder:(0,g._x)("Type your license here","user","nelio-ab-testing"),maxLength:Math.max(21,26),className:"nab-license-form__text-control",onChange:e=>s((0,f.trim)(e))}),(0,r.jsx)(l.Button,{variant:"primary",className:"nab-license-form__button",disabled:21!==a.length&&26!==a.length,onClick:()=>{t(),o(a)},children:(0,g._x)("Apply","command","nelio-ab-testing")})]}):null},Ve={monthly:{product:"nab-enterprise-monthly",quotaAddon:"nab-pageviews-monthly"},yearly:{product:"nab-enterprise-yearly",quotaAddon:"nab-pageviews-yearly"}},Ye=[Ve.monthly.product,Ve.yearly.product],qe=2e5,He=[0,2,4,6,11,16],Ge=({back:e,isOpen:n,placement:t,onClick:i,onFocusOutside:a})=>{const s=Ke(),o=We(),{wasYearly:c,previousAddonQuantity:b}=Je(),m=nn([b,...He.filter(e=>e>b)],7),[x,h]=(0,p.useState)(m[0]),[j,f]=(0,p.useState)(c),v=ze(j?"yearly":"monthly",x),y=c?"/"+(0,g._x)("year","text","nelio-ab-testing"):"",{upgradeSubscription:N}=(0,_.useDispatch)(Ce);return n?Ye.some(e=>!o.map(e=>e.id).includes(e))?(0,r.jsx)(l.Popover,{className:"nab-enterprise-upgrade-form nab-enterprise-upgrade-form nab-enterprise-upgrade-form--error",noArrow:!1,placement:t,onFocusOutside:a,children:(0,r.jsx)("p",{children:(0,g._x)("Something went wrong while retrieving plans. Please contact Nelio support.","user","nelio-ab-testing")})}):s?(0,r.jsx)(l.Popover,{className:"nab-enterprise-upgrade-form nab-enterprise-upgrade-form--loading",noArrow:!1,placement:t,onFocusOutside:a,children:(0,r.jsx)(l.Spinner,{})}):(0,r.jsxs)(l.Popover,{className:"nab-enterprise-upgrade-form",noArrow:!1,placement:t,onFocusOutside:a,children:[(0,r.jsxs)("div",{className:"nab-enterprise-upgrade-form__container",children:[(0,r.jsx)("h3",{children:(0,g.sprintf)("Enterprise%1$s",v?` (${v}${y})`:"")}),(0,r.jsx)(u,{label:(0,g._x)("Monthly Page Views","text","nelio-ab-testing"),value:`${x}`,options:m.map(e=>({value:`${e}`,label:en(qe+5e4*e)})),onChange:e=>h(Number.parseInt(e)),help:b>=0?(0,g.sprintf)(/* translators: %s: Number of page views. */ /* translators: %s: Number of page views. */
(0,g._x)("Currently set to %s","text","nelio-ab-testing"),en(qe+5e4*b)):void 0}),!c&&(0,r.jsx)(d,{checked:j,onChange:e=>f(e),label:(0,g._x)("Pay yearly","command","nelio-ab-testing")})]}),(0,r.jsxs)("div",{className:"nab-enterprise-upgrade-form__button-container",children:[e&&(0,r.jsx)(l.Button,{variant:"secondary",className:"nab-enterprise-upgrade-form__button",onClick:e,children:(0,g._x)("Back","command","nelio-ab-testing")}),(0,r.jsx)(l.Button,{variant:"primary",className:"nab-enterprise-upgrade-form__button",onClick:()=>{i(),N(j?Ve.yearly.product:Ve.monthly.product,x)},children:(0,g._x)("Upgrade Subscription","command (subscription)","nelio-ab-testing")})]})]}):null},Ke=()=>j(e=>!e(De.store).hasFinishedResolution("getProducts"),[]),We=()=>j(e=>e(De.store).getProducts(),[]),ze=(e,n)=>j(t=>{var i;const a=t(De.store).getProducts(),s=t(Ce).getCurrency()||"USD",o=a.find(n=>n.id===Ve[e].product),r=a.find(n=>n.id===Ve[e].quotaAddon);if(!o||!r)return"";const c=e=>{var n,t;return null!==(t=null!==(n=e.price[s])&&void 0!==n?n:e.price.USD)&&void 0!==t?t:0},l=(0,f.toPairs)(null!==(i=r.quantityDiscounts)&&void 0!==i?i:{}).map(([e,n])=>[Number.parseInt(e),n]).reduce((e,[t,i])=>t<=n?i:e,0),d=l/100,u=c(o)+c(r)*n*(1-d);return Ze(u,s)},[e,n]),Je=()=>j(e=>({wasYearly:"year"===e(Ce).getPeriod(),previousAddonQuantity:"enterprise"!==e(Ce).getPlan()?-1:e(Ce).getExtraQuotaUnits()}),[]),Xe=(()=>{try{return new Intl.NumberFormat((0,Pe.getLocale)().replace("_","-"))}catch(e){return new Intl.NumberFormat("en-US")}})(),Ze=(e,n)=>"EUR"===n?`${Xe.format(Math.ceil(e))}€`:`USD${Xe.format(Math.ceil(e))}`,en=e=>Xe.format(e),nn=(e,n)=>{var t;const i=e[e.length-1]||0,a=[...e,...(0,f.range)(1,n).map(e=>i+20*e)].slice(1,n);return[null!==(t=a[0])&&void 0!==t?t:0,...a.slice(1)]},tn=({isOpen:e,placement:n,onClick:t,onFocusOutside:i,showEnterprise:a})=>{const s=an(),o=sn(),c=on(),{upgradeSubscription:d}=(0,_.useDispatch)(Ce),[u,b]=(0,p.useState)("");return e?s?(0,r.jsx)(l.Popover,{className:"nab-regular-upgrade-form nab-regular-upgrade-form--loading",noArrow:!1,placement:n,onFocusOutside:i,children:(0,r.jsx)(l.Spinner,{})}):(0,r.jsxs)(l.Popover,{className:"nab-regular-upgrade-form",noArrow:!1,placement:n,onFocusOutside:i,children:[(0,r.jsxs)("div",{className:"nab-regular-upgrade-form__product-container",children:[(0,r.jsx)("h3",{children:(0,g._x)("Subscription Plans","text","nelio-ab-testing")}),(0,r.jsx)(l.RadioControl,{selected:u,options:o.map(({id:e,displayName:n,price:t,description:i,enabledAddons:a})=>({label:(0,r.jsxs)("div",{className:"nab-regular-upgrade-form__product",children:[(0,r.jsx)("strong",{className:"nab-regular-upgrade-form__product-name",children:ln(n)}),(0,r.jsx)("span",{className:"nab-regular-upgrade-form__product-price",title:c,children:cn(e,(t[c]||0)+a.reduce((e,n)=>e+(n.price[c]||0),0),c)}),(0,r.jsx)("span",{className:"nab-regular-upgrade-form__product-description",children:ln(i)})]}),value:e})),onChange:e=>{e&&("nab-enterprise-placeholder"!==e?b(e):a())}})]}),(0,r.jsx)("div",{className:"nab-regular-upgrade-form__button-container",children:(0,r.jsx)(l.Button,{variant:"primary",className:"nab-regular-upgrade-form__button",disabled:!u,onClick:()=>{t(),d(u,0)},children:(0,g._x)("Upgrade Subscription","command","nelio-ab-testing")})})]}):null},an=()=>j(e=>!e(De.store).hasFinishedResolution("getProducts"),[]),sn=()=>{const{currentProduct:e,products:n,enabledAddons:t}=j(e=>({products:e(De.store).getProducts(),currentProduct:e(Ce).getSubscriptionProduct(),enabledAddons:e(Ce).getSubscriptionAddons()}),[]),i=n.filter(({upgradeableFrom:n})=>n.includes(e)),a=i.filter(e=>!e.id.includes("enterprise")),s=i.find(e=>e.id.includes("enterprise-monthly"))||i.find(e=>e.id.includes("enterprise-yearly")),o=(0,p.useMemo)(()=>n.filter(e=>e.isAddon),[n]),r=(0,p.useCallback)(e=>{var n;return(null!==(n=null==e?void 0:e.allowedAddons)&&void 0!==n?n:[]).filter(e=>!!t.find(n=>dn(e,n))).map(e=>o.find(n=>n.id===e)).filter(e=>!!e)},[o,t]);return(0,p.useMemo)(()=>{var e;return[...a.map(e=>Object.assign(Object.assign({},e),{enabledAddons:r(e)})),Object.assign(Object.assign({price:{USD:0,EUR:0},description:{en:"",es:""},enabledAddons:r(s)},s),{id:"nab-enterprise-placeholder",displayName:(0,f.mapValues)(null!==(e=null==s?void 0:s.displayName)&&void 0!==e?e:{en:"",es:""},e=>(0,f.trim)(e.replace(/\([^)]*\)/,"")))})]},[a,s,r])},on=()=>j(e=>e(Ce).getCurrency()||"USD",[]),rn=(()=>{try{return new Intl.NumberFormat((0,Pe.getLocale)().replace("_","-"))}catch(e){return new Intl.NumberFormat("en-US")}})(),cn=(e,n,t)=>{const i="EUR"===t?`${rn.format(Math.ceil(n))}€`:`USD${rn.format(Math.ceil(n))}`;return"nab-enterprise-placeholder"===e?(0,g.sprintf)(/* translators: %s: Price. */ /* translators: %s: Price. */
(0,g._x)("starting from %s","text (money)","nelio-ab-testing"),i):i},ln=e=>(0,Pe.getLocale)().startsWith("es")?e.es.replace("de Nelio A/B Testing",""):e.en.replace("Nelio A/B Testing",""),dn=(e,n)=>{const t=e.substring(0,e.indexOf("addon-")),i=n.substring(0,n.indexOf("addon-"));return!!t&&!!i&&t===i},un=e=>{const n=j(e=>e(Ce).getPlan(),[]),[t,i]=(0,p.useState)(!1);return"enterprise"===n||t?(0,r.jsx)(Ge,Object.assign({back:"enterprise"!==n&&(()=>i(!1))},e)):(0,r.jsx)(tn,Object.assign({showEnterprise:()=>i(!0)},e))},bn=({siteId:e})=>{const n=Mn();return Dn()?(0,r.jsx)(Ie,{siteId:e}):(0,r.jsxs)("div",{className:"nab-account-container__box nab-plan",children:[(0,r.jsxs)("div",{className:"nab-plan__content",children:[(0,r.jsx)(pn,{}),(0,r.jsx)(gn,{}),(0,r.jsx)(m.QuotaMeter,{disabled:n.isLoading,subscriptionQuota:n.data})]}),(0,r.jsx)(mn,{})]})},pn=()=>{const{period:e}=Cn(),n=Pn(),t=On(),i=kn(),a="month"===e?(0,g._x)("Monthly","text","nelio-ab-testing"):(0,g._x)("Yearly","text","nelio-ab-testing");return(0,r.jsxs)("h3",{className:"nab-plan__title",children:[n,(0,r.jsx)("span",{className:"nab-plan__period",children:i?(0,g._x)("Free","text","nelio-ab-testing"):a}),"canceled"===t&&(0,r.jsx)("span",{className:"nab-plan__state",children:(0,g._x)("Canceled","text (account state)","nelio-ab-testing")})]})},gn=()=>{const e=kn(),n=En(),t=On(),i=An(),a=In(),s=Fn(),o=Ln();return e?(0,r.jsx)("div",{className:"nab-plan__renewal",children:(0,g._x)("You are using the free version of Nelio A/B Testing.","text","nelio-ab-testing")}):n?(0,r.jsx)("div",{className:"nab-plan__renewal",children:(0,p.createInterpolateElement)((0,g.sprintf)(/* translators: %s: Date. */ /* translators: %s: Date. */
(0,g._x)("You’re currently using a premium version of Nelio A/B Testing for free. This invitation will end on %s and the plugin will be downgraded to a free plan. Please consider subscribing before that.","user","nelio-ab-testing"),`<date>${(0,Pe.formatI18nDate)(s)}</date>`),{date:(0,r.jsx)("span",{className:"nab-plan__renewal-date"})})}):"canceled"===t?(0,r.jsx)("div",{className:"nab-plan__renewal",children:(0,p.createInterpolateElement)((0,g.sprintf)(/* translators: %s: Date. */ /* translators: %s: Date. */
(0,g._x)("Your subscription will end on %s.","text","nelio-ab-testing"),`<date>${(0,Pe.formatI18nDate)(a)}</date>`),{date:(0,r.jsx)("span",{className:"nab-plan__renewal-date"})})}):i?(0,r.jsx)("div",{className:"nab-plan__renewal",children:(0,p.createInterpolateElement)((0,g._x)("<link>Contact us</link> to get additional features to manage your account.","text","nelio-ab-testing"),{link:(0,r.jsx)("a",{href:"mailto:support@neliosoftware.com"})})}):(0,r.jsx)("div",{className:"nab-plan__renewal",children:(0,p.createInterpolateElement)((0,g.sprintf)(/* translators: %1$s: Price and currency. %2$s: Date. */ /* translators: %1$s: Price and currency. %2$s: Date. */
(0,g._x)("Next charge will be %1$s on %2$s.","text","nelio-ab-testing"),`<money>${o}</money>`,`<date>${(0,Pe.formatI18nDate)(s)}</date>`),{date:(0,r.jsx)("span",{className:"nab-plan__renewal-date"}),money:(0,r.jsx)("span",{className:"nab-plan__renewal-amount"})})})},mn=()=>{const e=kn(),n=En(),t=On();return An()?(0,r.jsxs)("div",{className:"nab-plan__actions",children:[(0,r.jsx)(jn,{}),(0,r.jsx)(fn,{})]}):e||n?(0,r.jsxs)("div",{className:"nab-plan__actions",children:[(0,r.jsx)(xn,{}),(0,r.jsx)(hn,{})]}):"canceled"===t?(0,r.jsx)("div",{className:"nab-plan__actions",children:(0,r.jsx)(Sn,{})}):(0,r.jsxs)("div",{className:"nab-plan__actions nab-plan__actions--separated",children:[(0,r.jsx)(vn,{}),(0,r.jsxs)("div",{className:"nab-plan__actions-group",children:[(0,r.jsx)(yn,{}),(0,r.jsx)(Nn,{}),(0,r.jsx)(wn,{})]})]})},xn=()=>{const[e,n]=(0,p.useState)(!1);return(0,r.jsxs)("span",{className:"nab-plan__action-container",children:[(0,r.jsx)(l.Button,{variant:"secondary",className:"nab-plan__action",onClick:()=>n(!0),children:(0,g._x)("Use License","command","nelio-ab-testing")}),(0,r.jsx)(Qe,{placement:"bottom",onFocusOutside:()=>n(!1),onClick:()=>n(!1),isOpen:e})]})},hn=()=>{const e=Tn();return(0,r.jsx)(l.ExternalLink,{className:"nab-plan__action components-button is-primary",href:(0,y.getSubscribeLink)(e),children:(0,y.getSubscribeLabel)(e)})},jn=()=>{const{plan:e}=Cn();return"enterprise"===e?null:(0,r.jsx)(l.ExternalLink,{className:"nab-plan__action components-button is-secondary",href:"mailto:support@neliosoftware.com?subject=Buy%20Quota",children:(0,g._x)("Buy More Quota","command","nelio-ab-testing")})},fn=()=>(0,r.jsx)(l.ExternalLink,{className:"nab-plan__action components-button is-primary",href:"mailto:support@neliosoftware.com?subject=Upgrade%20Subscription",children:(0,g._x)("Upgrade Subscription","command","nelio-ab-testing")}),vn=()=>{const[e,n]=(0,p.useState)(!1),{cancelSubscription:t}=(0,_.useDispatch)(Ce),i=Fn();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.Button,{isDestructive:!0,className:"nab-plan__action",onClick:()=>n(!0),children:(0,g._x)("Cancel Subscription","command","nelio-ab-testing")}),(0,r.jsx)(m.ConfirmationDialog,{title:(0,g._x)("Cancel Subscription?","text","nelio-ab-testing"),text:(0,g.sprintf)(/* translators: %s: Date. */ /* translators: %s: Date. */
(0,g._x)("Canceling your subscription will cause it not to renew. If you cancel your subscrition, it will continue until %s. Then, the subscription will expire and will not be invoiced again. Do you want to cancel your subscription?","user","nelio-ab-testing"),(0,Pe.formatI18nDate)(i)),isDestructive:!0,confirmLabel:(0,g._x)("Cancel Subscription","command","nelio-ab-testing"),cancelLabel:(0,g._x)("Back","command","nelio-ab-testing"),onCancel:()=>n(!1),onConfirm:()=>{n(!1),t()},isOpen:e})]})},yn=()=>{const[e,n]=(0,p.useState)(!1),{plan:t}=Cn();return"enterprise"===t?null:(0,r.jsxs)("div",{children:[(0,r.jsx)(l.Button,{variant:"secondary",className:"nab-plan__action",onClick:()=>n(!e),children:(0,g._x)("Buy More Quota","command","nelio-ab-testing")}),(0,r.jsx)(m.QuotaPurchasePopover,{placement:"bottom",onClick:()=>n(!1),onFocusOutside:()=>n(!1),isOpen:e})]})},Nn=()=>{const[e,n]=(0,p.useState)(!1);return(0,r.jsxs)("div",{children:[(0,r.jsx)(l.Button,{variant:"secondary",className:"nab-plan__action",onClick:()=>n(!e),children:(0,g._x)("Addons","text","nelio-ab-testing")}),(0,r.jsx)(Te,{placement:"bottom",onFocusOutside:()=>n(!1),isOpen:e})]})},wn=()=>{const[e,n]=(0,p.useState)(!1);return(0,r.jsxs)("div",{children:[(0,r.jsx)(l.Button,{variant:"primary",className:"nab-plan__action",onClick:()=>n(!e),children:(0,g._x)("Upgrade Subscription","command","nelio-ab-testing")}),(0,r.jsx)(un,{placement:"bottom",onClick:()=>n(!1),onFocusOutside:()=>n(!1),isOpen:e})]})},Sn=()=>{const[e,n]=(0,p.useState)(!1),{uncancelSubscription:t}=(0,_.useDispatch)(Ce),i=Fn();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.Button,{variant:"primary",className:"nab-plan__action",onClick:()=>n(!0),children:(0,g._x)("Reactivate Subscription","command","nelio-ab-testing")}),(0,r.jsx)(m.ConfirmationDialog,{title:(0,g._x)("Reactivate Subscription?","text","nelio-ab-testing"),text:(0,g.sprintf)(/* translators: %s: Date. */ /* translators: %s: Date. */
(0,g._x)("Reactivating your subscription will cause it to renew on %s. Do you want to reactivate your subscription?","user","nelio-ab-testing"),(0,Pe.formatI18nDate)(i)),confirmLabel:(0,g._x)("Reactivate Subscription","command","nelio-ab-testing"),cancelLabel:(0,g._x)("Back","command","nelio-ab-testing"),onCancel:()=>n(!1),onConfirm:()=>{n(!1),t()},isOpen:e})]})},Cn=()=>j(e=>({period:e(Ce).getPeriod(),plan:e(Ce).getPlan()}),[]),On=()=>j(e=>e(Ce).getState(),[]),An=()=>j(e=>e(Ce).isSubscriptionDeprecated(),[]),kn=()=>j(e=>"free"===e(Ce).getMode(),[]),En=()=>j(e=>"invitation"===e(Ce).getMode(),[]),Dn=()=>j(e=>e(Ce).isAgency()&&!e(Ce).isAgencyFullViewEnabled(),[]),Pn=()=>j(e=>e(Ce).getProductDisplay(),[]),In=()=>j(e=>e(Ce).getDeactivationDate()||e(De.store).getToday(),[]),Fn=()=>j(e=>e(Ce).getNextChargeDate()||e(De.store).getToday(),[]),Ln=()=>j(e=>e(Ce).getNextChargeTotal(),[]),Tn=()=>j(e=>e(De.store).getToday(),[]),Mn=()=>j(e=>({data:e(Ce).getSubscriptionQuota(),isLoading:!e(Ce).hasFinishedResolution("getSubscriptionQuota")}),[]);const Bn=e=>{var{label:n}=e,t=function(e,n){var t={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&n.indexOf(i)<0&&(t[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(i=Object.getOwnPropertySymbols(e);a<i.length;a++)n.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(t[i[a]]=e[i[a]])}return t}(e,["label"]);const[i,a]=(0,p.useState)(!1),s=j(e=>e(De.store).getPluginSetting("siteId"),[]),o=j(e=>e(Ce).isLocked(),[]),{unlinkSite:c}=(0,_.useDispatch)(Ce);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.Button,Object.assign({onClick:()=>a(!0),disabled:o},t,{children:n})),(0,r.jsx)(m.ConfirmationDialog,{title:(0,g._x)("Downgrade to Free Version?","text","nelio-ab-testing"),text:(0,g._x)("This action will remove the license from this site so that you can use it somewhere else. Nelio A/B Testing will remain active on this site, but you will be using the free version instead. Do you want to continue?","user","nelio-ab-testing"),confirmLabel:(0,g._x)("Downgrade","command (remove license)","nelio-ab-testing"),cancelLabel:(0,g._x)("Back","command","nelio-ab-testing"),isDestructive:!0,onCancel:()=>a(!1),onConfirm:()=>{c(s),a(!1)},isOpen:i})]})},Rn=()=>{const e=Un(),n=$n(),t=Qn(),i=Vn(),a=Yn(),s=qn(),[o,c]=(0,p.useState)(!1);return e?(0,r.jsxs)("div",{className:"nab-account-container__box nab-info",children:[(0,r.jsx)("h3",{className:"nab-info__title",children:(0,g._x)("Account Information","title (account)","nelio-ab-testing")}),(0,r.jsxs)("div",{className:"nab-info__container",children:[(0,r.jsx)("div",{className:"nab-info__profile",children:(0,r.jsx)("div",{className:"nab-info__picture nab-first-letter-a",children:(0,r.jsx)("div",{className:"nab-info__actual-picture",style:{backgroundImage:`url(${s})`}})})}),(0,r.jsxs)("div",{className:"nab-info__details",children:[(0,r.jsx)("p",{className:"nab-info__name",children:n}),(0,r.jsxs)("p",{className:"nab-info__email",children:[(0,r.jsx)(l.Dashicon,{icon:"email",className:"nab-info__icon"}),t]}),(0,r.jsxs)("p",{className:"nab-info__creation-date",children:[(0,r.jsx)(l.Dashicon,{icon:"calendar",className:"nab-info__icon"}),(0,p.createInterpolateElement)((0,g.sprintf)(/* translators: %s: Date. */ /* translators: %s: Date. */
(0,g._x)("Member since %s.","text","nelio-ab-testing"),`<date>${(0,Pe.formatI18nDate)(i)}</date>`),{date:(0,r.jsx)("strong",{})})]}),(0,r.jsxs)("div",{className:"nab-info__license",children:[(0,r.jsx)(l.Dashicon,{icon:"admin-network",className:"nab-info__icon"}),(0,r.jsx)("code",{title:(0,g._x)("License Key","text","nelio-ab-testing"),children:a}),(0,r.jsxs)("div",{className:"nab-info__change-license",children:[(0,r.jsx)(l.Button,{variant:"link",onClick:()=>c(!0),children:(0,g._x)("Change","command","nelio-ab-testing")}),(0,r.jsx)(Qe,{isOpen:o,placement:"bottom",onClick:()=>c(!1),onFocusOutside:()=>c(!1)})]}),(0,r.jsx)("div",{className:"nab-info__remove-license",children:(0,r.jsx)(Bn,{variant:"link",isDestructive:!0,label:(0,g._x)("Remove","command","nelio-ab-testing")})})]})]})]})]}):null},Un=()=>j(e=>{const{getMode:n,isAgency:t,isAgencyFullViewEnabled:i}=e(Ce),a="regular"===n(),s=t()&&!i();return a&&!s},[]),$n=()=>j(e=>e(Ce).getFullname(),[]),Qn=()=>j(e=>e(Ce).getEmail(),[]),Vn=()=>j(e=>e(Ce).getStartDate()||e(De.store).getToday(),[]),Yn=()=>j(e=>e(Ce).getLicense(),[]),qn=()=>j(e=>e(Ce).getPhoto(),[]);function Hn(e){var n,t,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e)if(Array.isArray(e)){var a=e.length;for(n=0;n<a;n++)e[n]&&(t=Hn(e[n]))&&(i&&(i+=" "),i+=t)}else for(t in e)e[t]&&(i&&(i+=" "),i+=t);return i}const Gn=function(){for(var e,n,t=0,i="",a=arguments.length;t<a;t++)(e=arguments[t])&&(n=Hn(e))&&(i&&(i+=" "),i+=n);return i},Kn=window.nab.i18n,Wn=({displayQuotaLimit:e,actualUrl:n,id:t,isCurrentSite:i,usedMonthlyQuota:a,maxMonthlyQuota:s,url:o})=>(0,r.jsxs)("li",{className:"nab-site",children:[(0,r.jsxs)("span",{className:"nab-site__details",children:[i?(0,r.jsxs)("span",{className:"nab-site__url",children:[(0,r.jsxs)("span",{className:"nab-site__current-site",children:[n,!!n&&o!==n&&(0,r.jsx)(m.HelpIcon,{className:"nab-site__current-site-help",type:"info",text:(0,g.sprintf)(/* translators: %s: Site URL. */ /* translators: %s: Site URL. */
(0,g._x)("Activation URL is “%s”","text","nelio-ab-testing"),o)})]}),(0,r.jsx)("span",{className:"nab-site__label",children:(0,g._x)("This site","text","nelio-ab-testing")})]}):(0,r.jsx)("span",{className:"nab-site__url",children:(0,r.jsx)("a",{href:o,className:Gn("nab-site__link",{"nab-site__link--current":i}),target:"_blank",rel:"noopener noreferrer",children:o})}),!!e&&(0,r.jsxs)("small",{children:[(0,r.jsxs)("strong",{children:[(0,g._x)("Quota Usage","text","nelio-ab-testing"),": "]}),(0,Kn.numberFormat)(a)," / ",Zn(s)]})]}),(0,r.jsx)(zn,{siteId:t}),(0,r.jsx)(Jn,{siteId:t})]}),zn=({siteId:e})=>{const[n,t]=(0,p.useState)(!1),i=j(e=>e(De.store).canLimitSiteQuota(),[]),{limitSiteQuota:a}=(0,_.useDispatch)(Ce),s=j(n=>{var t,i;return null!==(i=null===(t=n(Ce).getSite(e))||void 0===t?void 0:t.maxMonthlyQuota)&&void 0!==i?i:-1},[e]);return i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.Button,{variant:"tertiary",className:"nab-site__limit-quota-button",onClick:()=>t(!0),children:(0,g._x)("Limit Quota","command","nelio-ab-testing")}),n&&(0,r.jsx)(Xn,{initialValue:`${s}`,onClose:()=>t(!1),onSave:n=>a(e,n)})]}):null},Jn=({siteId:e})=>{const[n,t]=(0,p.useState)(!1),{unlinkSite:i}=(0,_.useDispatch)(Ce);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.Button,{isDestructive:!0,variant:"tertiary",className:"nab-site__unlink-button",onClick:()=>t(!0),children:(0,g._x)("Unlink Site","command","nelio-ab-testing")}),(0,r.jsx)(m.ConfirmationDialog,{title:(0,g._x)("Unlink Site?","text","nelio-ab-testing"),text:(0,g._x)("This will remove the subscription license from the site.","text","nelio-ab-testing"),confirmLabel:(0,g._x)("Unlink","command","nelio-ab-testing"),isOpen:n,onCancel:()=>t(!1),onConfirm:()=>{t(!1),i(e)}})]})},Xn=({initialValue:e,onClose:n,onSave:t})=>{const[i,a]=(0,p.useState)(!1),[s,o]=(0,p.useState)(e),c=s!==e;return(0,r.jsxs)(l.Modal,{className:"site-quota-dialog",title:(0,g._x)("Site Quota","text","nelio-ab-testing"),onRequestClose:f.noop,isDismissible:!1,children:[(0,r.jsx)(d,{checked:"-1"!==s,onChange:e=>o(e?"1000":"-1"),label:(0,g._x)("Limit quota usage in this site","command","nelio-ab-testing")}),"-1"!==s&&(0,r.jsx)(b,{type:"number",min:"0",value:s,onChange:o}),(0,r.jsxs)("div",{className:"site-quota-dialog__actions",children:[(0,r.jsx)(l.Button,{variant:"secondary",onClick:n,children:c?(0,g._x)("Discard Changes","command","nelio-ab-testing"):(0,g._x)("Close","command","nelio-ab-testing")}),(0,r.jsx)(l.Button,{variant:"primary",onClick:()=>{const e=Number.parseInt(s),i=-1===e?-1:Math.abs(e);a(!0),t(i).then(n).catch(()=>a(!1))},disabled:!c||i,children:i?(0,g._x)("Saving…","text","nelio-ab-testing"):(0,g._x)("Save","command","nelio-ab-testing")})]})]})},Zn=e=>-1===e?"∞":(0,Kn.numberFormat)(e),et=()=>{const e=tt(),n=nt(),t=it(),i=at();if(!e)return null;const a=t.length,s=t.length>1||t.some(e=>0<=e.maxMonthlyQuota);return(0,r.jsxs)("div",{className:"nab-account-container__box nab-sites",children:[(0,r.jsxs)("h3",{className:"nab-sites__title",children:[(0,g._x)("Sites","text","nelio-ab-testing"),n&&(0,r.jsx)(l.Spinner,{}),(0,r.jsx)("span",{className:"nab-sites__availability",children:`${a} / ${i}`})]}),(0,r.jsx)("ul",{className:"nab-sites__list",children:!n&&t.map(e=>(0,r.jsx)(Wn,Object.assign({displayQuotaLimit:s},e),e.id))})]})},nt=()=>j(e=>!e(Ce).hasFinishedResolution("getSites",[e(Ce).getSubscriptionId()]),[]),tt=()=>j(e=>{const{getMode:n,isAgency:t,isAgencyFullViewEnabled:i}=e(Ce),a="regular"===n(),s=t()&&!i();return a&&!s},[]),it=()=>j(e=>e(Ce).getSites(e(Ce).getSubscriptionId())||y.EMPTY_ARRAY,[]),at=()=>j(e=>"enterprise"===e(Ce).getPlan()?"∞":e(Ce).getSitesAllowed(),[]),st=({invoiceUrl:e,reference:n,chargeDate:t,isRefunded:i,subtotalDisplay:a})=>(0,r.jsxs)("tr",{className:"nab-invoice",children:[(0,r.jsx)("td",{className:"nab-invoice__reference",children:(0,r.jsx)("a",{href:e,className:"nab-invoice__link",target:"_blank",rel:"noopener noreferrer",children:n})}),(0,r.jsx)("td",{className:"nab-invoice__date",children:t}),(0,r.jsxs)("td",{className:"nab-invoice__total",children:[i&&(0,r.jsx)("span",{className:"nab-invoice__label",children:(0,g._x)("(Refunded)","text (invoice)","nelio-ab-testing")}),(0,r.jsx)("span",{className:Gn("nab-invoice__total-value",{"nab-invoice__total-value--refunded":i}),children:a})]})]}),ot=()=>{const e=rt(),n=ct(),t=lt(),i=dt();return e?(0,r.jsxs)("div",{className:"nab-account-container__box nab-billing",children:[(0,r.jsxs)("h3",{className:"nab-billing__title",children:[(0,g._x)("Billing History","text","nelio-ab-testing"),n&&(0,r.jsx)(l.Spinner,{})]}),!n&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.ExternalLink,{className:"nab-billing__action",href:i,children:(0,g._x)("Manage Payments","user","nelio-ab-testing")}),(0,r.jsxs)("table",{className:"nab-billing__container",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"nab-billing__reference",children:(0,g._x)("Invoice Reference","text (account, billing table title)","nelio-ab-testing")}),(0,r.jsx)("th",{className:"nab-billing__date",children:(0,g._x)("Date","text (account, billing table title)","nelio-ab-testing")}),(0,r.jsx)("th",{className:"nab-billing__total",children:(0,g._x)("Total","text (account, billing table title)","nelio-ab-testing")})]})}),(0,r.jsx)("tbody",{className:"invoice-list",children:t.map(e=>(0,r.jsx)(st,Object.assign({},e),e.reference))})]})]})]}):null},rt=()=>j(e=>{const{getMode:n,isAgency:t,isAgencyFullViewEnabled:i,isSubscriptionDeprecated:a}=e(Ce),s="regular"===n(),o=a(),r=t()&&!i();return s&&!o&&!r},[]),ct=()=>j(e=>!e(Ce).hasFinishedResolution("getInvoices",[e(Ce).getSubscriptionId()]),[]),lt=()=>j(e=>e(Ce).getInvoices(e(Ce).getSubscriptionId()),[]),dt=()=>j(e=>e(Ce).getUrlToManagePayments(),[]),ut=()=>j(e=>e(Ce).isLocked(),[])?(0,r.jsx)(l.Modal,{className:"nab-locked",title:(0,g._x)("Loading…","text","nelio-ab-testing"),shouldCloseOnEsc:!1,shouldCloseOnClickOutside:!1,isDismissible:!1,onRequestClose:f.noop,children:(0,r.jsx)(l.Spinner,{})}):null,bt=({siteId:e})=>(0,r.jsxs)("div",{className:"nab-account-container",children:[(0,r.jsx)(bn,{siteId:e}),(0,r.jsx)(Rn,{}),(0,r.jsx)(et,{}),(0,r.jsx)(ot,{}),(0,r.jsx)(ut,{})]});function pt(e,n){const{siteId:t,isSubscribed:i}=n,a=document.getElementById(e);var s,o;s=(0,r.jsxs)(l.SlotFillProvider,{children:[(0,r.jsx)(h,{isSubscribed:i,siteId:t}),(0,r.jsx)(Oe,{children:(0,r.jsx)(bt,{siteId:t})}),(0,r.jsx)(l.Popover.Slot,{})]}),(o=a)&&(p.createRoot?(0,p.createRoot)(o).render(s):(0,p.render)(s,o)),(0,m.appendContextualHelp)({screen:"account",questions:x})}}},t={};function i(e){var a=t[e];if(void 0!==a)return a.exports;var s=t[e]={exports:{}};return n[e](s,s.exports,i),s.exports}e=[],i.O=(n,t,a,s)=>{if(!t){var o=1/0;for(d=0;d<e.length;d++){for(var[t,a,s]=e[d],r=!0,c=0;c<t.length;c++)(!1&s||o>=s)&&Object.keys(i.O).every(e=>i.O[e](t[c]))?t.splice(c--,1):(r=!1,s<o&&(o=s));if(r){e.splice(d--,1);var l=a();void 0!==l&&(n=l)}}return n}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[t,a,s]},i.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return i.d(n,{a:n}),n},i.d=(e,n)=>{for(var t in n)i.o(n,t)&&!i.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},i.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a=i.O(void 0,[4501],()=>i(8409));a=i.O(a);var s=nab="undefined"==typeof nab?{}:nab;for(var o in a)s[o]=a[o];a.__esModule&&Object.defineProperty(s,"__esModule",{value:!0})})();